%self_confining_ringlets.tex
%
%by Joe Hahn et al, jhahn@spacescience.org, 20 November 2018.
%
%draft ApJ paper on epi_int_lite simulations of self confining ringlets.
%
%to compile:
%    pdflatex self_confining_ringlets
%    bibtex self_confining_ringlets
%    pdflatex self_confining_ringlets


\documentclass[preprint]{aastex62}

%bibliography, see
%http://ads.harvard.edu/pubs/bibtex/astronat/doc/html/astronat_3.html
\usepackage{natbib}
\usepackage{amsmath}
%\citestyle{aa}

%journal
\received{not yet}
\revised{not yet}
\accepted{not yet}
\submitjournal{Somewhere, eventually}

%short names
\shorttitle{Narrow Eccentric Ringlets}
\shortauthors{Hahn et al.}


\begin{document}


%title page
\title{N-body simulations of the Self--Confinement of 
Viscous Self--Gravitating Narrow Eccentric Planetary Ringlets}

\correspondingauthor{Joseph M. Hahn}
\email{jhahn@spacescience.org}

\author{Joseph M. Hahn}
\affiliation{Space Science Institute}

\author{Douglas P. Hamilton}
\affiliation{University of Maryland}

\author{Thomas Rimlinger}
\affiliation{University of Maryland}

\author{Lucy Luu}
\affiliation{University of Maryland}


%abstract
\begin{abstract}

N-body simulations are used
to illustrate how a viscous self-gravitating narrow eccentric planetary ringlet can evolve into a 
self--confining state.

\end{abstract}


%keywords
\keywords{editorials, notices --- miscellaneous --- catalogs --- surveys --- update, me}


\section{Introduction}
\label{sec:intro}

Narrow eccentric planetary ringlets have properties both interesting and
not well understood: sharp edges,
sizable eccentricity gradients, and a confinement mechanism that
opposes radial spreading due to ring viscosity. To date, nearly all of the
prevailing ringlet confinement mechanisms assume that there also exists a pair of 
unseen shepherd satellites that straddle the ringlet, with those shepherds' gravities
also torquing the ringlet's edges' in a way that keeps it radially confined 
(\citealt{GT79, GT79c, GT81, CG00, ME02}). However the Cassini spacecraft failed to detect
any such shepherds near Saturn's narrow ringlets, which casts doubt upon that confinement mechanism
\citep{L18}. Note though that \cite{BGT82} showed that a viscous ringlet that has
a sufficiently high eccentricity gradient can in fact be self-confining,
due to the resulting reversal of the viscous angular momentum flux. 
Which motivates this study, which uses the epi\_int\_lite N-body integrator to 
investigate whether a viscous and self--gravitating ringlet might evolve into a self-confining state.

\section{epi\_int\_lite}
\label{sec:epi_int_lite}

Epi\_int\_lite is a child of the epi\_int N-body integrator that was used to
simulate the outer edge of Saturn's B ring while it is sculpted by satellite perturbations
\citep{HS13}. The new code is very similar to its parent but differs in two significant ways:
({\it i}.) epi\_int\_lite is written in python and is recoded for more efficient execution, and
({\it ii}.) epi\_int\_lite uses a more reliable drift step to handle
unperturbed motion around an oblate planet (detailed in Appendix \ref{sec:Appendix A}).

Otherwise epi\_int\_lite's treatment of ring self--gravity and viscosity are identical
to that used by the parent code, see \cite{HS13} for additional details. The epi\_int\_lite 
source code is available at https://github.com/joehahn/epi\_int\_lite, and the
code's numerical quality is benchmarked in Appendix \ref{sec:Appendix B}
where the output of several numerical experiments are compared against theoretical expectations.

Calculations by epi\_int\_lite use natural units with gravitation constant $G=1$, 
central primary mass $M=1$, and the ringlet's inner edge has initial radius
$r_0=1$, and so the ringlet masses $m_r$ and radii $r$ quoted below are in units of $M$ and $r_0$.
Converting code output from natural units to physical units requires choosing	
physical values for $M$ and $r_0$ and multiplying accordingly, and when this text does so
it assumes Saturn's mass $M=5.68\times10^{29}$ gm and a characteristic
ring radius $r_0=1.0\times10^{10}$ cm. Simulation time $t$ is in units of $T_{\text{orb}}/2\pi$
where $T_{\text{orb}} = 2\pi\sqrt{r_0^3/GM}$ is the orbit period at $r_0$, 
so divide simulation time $t$ by $2\pi$ and multiply
by $T_{\text{orb}}$ to convert simulation time from natural to physical units.
The simulated particles' motions during the drift step are also
sensitive to the $J_2$ portion of the primary's non-spherical gravity component 
(see Appendix \ref{sec:Appendix B}), and all simulations
adopt Saturn-like values of $J_2=0.01$ and $R_p=r_0/2$ where $R_p$ is the planet's
mean radius.

\subsection{streamlines}
\label{subsec:streamlines}

Initially all particles are assigned to various streamlines across the simulated ringlet. A streamline
is a closed eccentric path around the primary, and each streamline is populated by $N_p$ particles that are
initially assigned a common semimajor axis $a$ and eccentricity $e$ while
distributed uniformly in longitude. Most of the simulations described below
employ only $N_s=2$ streamlines, so that the model output can be compared against
theoretical treatments that also treat the ringlet as two gravitating streamlines
(e.g.\ \citealt{BGT83}). But the following also performs a few higher-resolution simulations
using $N_s=5-31$ streamlines, to demonstrate that the $N_s=2$ treatment is perfectly
adequate and reproduces all the relevant dynamics. All simulations use $N_p=241$ particles 
per streamline, and the total number of particles is $N_sN_p$.
Note that the assignment of particles to a given streamline is merely
for labeling purposes, as particles are still free to wander in response
to the ringâ€™s internal forces, namely, ring gravity and viscosity. But as \cite{HS13} as well
as this work shows, the simulated ring stays coherent and highly organized throughout the 
simulation such that particles on the same streamline do not pass each other longitudinally,
nor do they cross adjacent streamlines. Because the simulated ringlet stays highly organized,
there is no radial or longitudinal mixing of the ring particles, and simulated particles preserve
their streamline membership over time. 

The epi\_int\_lite code also monitors all particles and checks whether any have crossed adjacent streamlines.
If that happens the simulation is then terminated since the particles' subsequent evolution
would no longer be computed reliably.

\subsection{N-body method}
\label{subsec:N-body method}

The epi\_int\_lite N-body integrator uses the same drift-kick
scheme used by the MERCURY Nbody algorithm \citep{C99} except that
epi\_int\_lite particles that do not interact with each other directly.
Rather, epi\_int\_lite particles
are only perturbed by the accelerations exerted by the ringlet's individual streamlines. 
Those accelerations are sensitive to the streamline's relative separations and orientations, 
which are inferred from the particles' positions
and velocities. Epi\_int\_lite particles are thus tracer particles
that indicate the streamlines' locations and orientations, which the N-body
integrator uses to compute the orbital evolution of those tracer particles
due to the perturbations exerted by those streamlines. This streamline approach 
is widely used in theoretical studies of planetary rings (c.f.\ \citealt{GT79, BGT83, BGT85})
as well as in N-body studies of rings \citep{HS13, RHH16}. The great benefit of the streamline concept
in numerical work is that it allows one to swiftly track the 
global evolution of the ringlet's streamlines numerically
using only a modest numbers of trace particles, typically $N_sN_p\sim500$.

The simulations reported on here account for streamline gravity
and ringlet viscosity. Because a ringlet is narrow, all particles
are in close proximity to the nearby portions of all streamlines,
which allows us to approximate a streamline as an infinitely
long wire of matter having linear density $\lambda$.
Consequently the gravity of each perturbing streamline draws a particle
towards that streamline with acceleration
\begin{equation}
\label{eqn:gravity}
    A_g=\frac{2G\lambda}{\Delta },
\end{equation}
where $\Delta$ is the particle's distance from the streamline.

The hydrodynamic approximation is used here to account for
the dissipation that occurs as particles in adjacent particle streamlines
shear past and collide with the perturbed particle,
without having to monitor individual particle-particle collisions.
The particle's acceleration due to the ring particles' shear viscosity is
\begin{equation}
\label{eqn:shear_viscosity}
    A_{\nu,\parallel}=-\frac{1}{\sigma r}\frac{\partial {\cal F}_L}{\partial r},
\end{equation}
where $r$ is the particle's radial coordinate, 
$\sigma$ is the surface density of ringlet matter, and 
${\cal F}_{L,\nu}$ is the flux of angular momentum
that is transported radially across the particle's streamline
due to its collisions with particles in adjacent streamlines, {\it i.e.}\
\begin{equation}
    \label{eqn:F_nu_theta}
    {\cal F}_{L,\nu} = -\nu_s \sigma r^2\frac{\partial\omega}{\partial r}
\end{equation}
where $\nu_s$ is the ringlet's kinematic shear viscosity
and $\omega=v_\theta/r$ is the particle's angular velocity \citep{HS13}.
The acceleration $A_{\nu,\parallel }$ is parallel to the perturbed particle's streamline
{\it i.e.}\ parallel to particle's velocity vector
$\mathbf{v}=\dot{\mathbf{r}}=v_r\hat{r} + v_\theta\hat{\theta}$ 
where $\mathbf{r} = r\hat{\mathbf{r}}$ is the particle's position vector.

Dissipative collisions also transmits linear momentum in the perpendicular direction,
which results in the additional acceleration
\begin{equation}
\label{eqn:bulk_viscosity}
    A_{\nu, \perp}=-\frac{1}{\sigma}\frac{\partial {\cal G}}{\partial r} 
\end{equation}
where the radial flux of linear momentum due to ringlet viscosity is
\begin{equation}
    \label{eqn:G}
    {\cal G} = -\left(\frac{4}{3}\nu_s + \nu_b\right)\sigma\frac{\partial v_r}{\partial r}
        -\left(\nu_b - \frac{2}{3}\nu_s\right)\frac{\sigma v_r}{r}
\end{equation}
$\nu_b$ is the ringlet's kinematic bulk viscosity and $v_r$ is the paricle's radial velocity
\citep{HS13}.

In the hydrodynamic approximation there is also the acceleration due to ringlet pressure $p$
that is due to particle-particle collisions,
\begin{equation}
\label{eqn:pressure}
    A_p=-\frac{1}{\sigma }\frac{\partial p}{\partial r}.
\end{equation}
Epi\_int\_lite treats the particle ring as a dilute gas of
colliding particles for which the 1D pressure is $p=c^2\sigma$ where
c is the particles dispersion velocity. However \cite{HS13} found ring pressure
to be inconsequential in N-body simulations of Saturn's A ring, and the ringlet simulation
examined in great detail in Section \ref{subsec:nominal} 
also showed no sensitivity to pressure effects, so all other
simulations reported on here have $c=0$.

\section{N-body simulations of viscous gravitating ringlets}
\label{sec:nbody}

The folowing describes a suite of N-body simulations of narrow viscous gravitating planetary
ringlets, to highlight the range of initial ringlet conditions that do evolve into
a self-confining state, and those that do not.

\subsection{nominal model}
\label{subsec:nominal}

Figure \ref{fig:a_nominal} shows the semimajor axis evolution of what is referred to
as the nominal model since this ringlet readily evolves into a self-confining state.
The simulated ringlet is composed of $N_s=2$ streamlines having $N_p=241$ particles
per streamline, and the integrator timestep is $\Delta t=0.5$ in natural units, so
the integrator samples the particles' orbits $2\pi/\Delta t\simeq13$ times per orbit, and this
ringlet is evolved for $1.4\times10^5$ orbits, which requires 50 minutes execution time
on a ten year old laptop. The ringlet's mass is
$m_r=10^{-10}$, its shear viscosity is $\nu_s=10^{-13}$, and its
bulk viscosity is $\nu_b=\nu_s$. The ringet's initial radial width is
$\Delta a_0 = 10^{-4}$, its initial eccentricity is $e=0.01$, and its
eccentricity gradient is initially zero. A convenient measure of time is the ringlet's
viscous radial spreading timescale
\begin{equation}
\label{eqn:viscous-timesscale}
    \tau_\nu=\frac{\Delta a_0^2}{12\nu_s} 
\end{equation}
which can be inferred from Eqn.\ (2.13) of \cite{P81}. 
This simulation's viscous timescale is $\tau_\nu=8.3\times10^3$ in natural units
or $\tau_\nu/2\pi=1.3\times10^3$ orbital periods. If this ringlet were orbiting Saturn
at $r_0=1.0\times10^{10}$ cm then the simulated ringlet's physical mass
would be $m_r=5.7\times10^{19}$ gm which is equivalent to the mass of a $24$ km radius iceball assuming
a volume density $\rho=1$ gm/cm$^3$, and the ringlet's initial physical radial width would be
$\Delta a_0 = 10^{-4}r_0=10$ km. This ringlet's
orbit period would be $T_{orb}=2\pi\sqrt{r_0^3/GM}=9.0$ hours in physical units, so 
the ringlet's viscous timescale is $\tau_\nu=1.4$ years, and
so its shear viscosity is $\nu_s=\Delta a_0^2/12\tau_\nu = 1.9\times10^3$ cm$^2$/sec
when evaluated in physical units. 
This ringlet's initial surface density would be $\sigma=m_r/2\pi r_0\Delta a_0=900$ gm/cm$^2$, but
Figs.\ \ref{fig:a_nominal}--\ref{fig:da_nominal} show that shrinks by a factor of about 5 as the 
ringlet's sememajor axis width $\Delta a$ grows via viscous spreading until it settles into
the self-confining state at time $t\sim40\tau_\nu$.
This so-called nominal ringlet is probably somewhat overdense and overly viscous compared to known 
planetary ringlets,
but that is by design so that the simulated ringlet quickly settles into the self-confining state.
Section \ref{subsec:variations} also shows how outcomes vary 
when a wide variety of alternate initial masses, widths, and viscosities are also considered.

\begin{figure}
\plotone{figs/da_nominal.pdf}
\caption{Evolution of the nominal ringlet's semimajor axes $a$
versus time $t$ in units of the ringlet's viscous timescale
$\tau_\nu=1.3\times10^3$ orbital periods. This ringlet is composed of $N_s=2$ streamlines,
and the outer (blue) and inner (green) streamlines' semimajor axes are plotted relative
to their mean $a_{\text{mean}}$, and displayed in units of the ringlet's
initial width $\Delta a_0 = 10^{-4}$ in natural units ({\it i.e.}\ $G=M=r_0=1$).
The simulated ringlet has total mass $m_r=10^{-10}$, shear viscosity $\nu_s=10^{-13}$,
and initial eccentricity $e=0.01$. See Section \ref{subsec:nominal} to convert
$m_r$, $a$ and $\nu_s$ from natural units to physical units.
\label{fig:a_nominal}}
\end{figure}

\begin{figure}
\plotone{figs/width_nominal.pdf}
\caption{
\label{fig:da_nominal}
The nominal ringlet's semimajor axis width $\Delta a = a_{\text{outer}} - a_{\text{inner}}$ over time
and in units of its initial radial width $\Delta a_0$.}
\end{figure}

Figure \ref{fig:e_nominal} shows that the outer streamline's eccentricity initially grows at the
expense of the inner streamline's, and that is a consequence the self-gravitating ringlet's
secular perturbations of itself, which is also demonstrated in Appendix \ref{sec:Appendix D}. 
Figure \ref{fig:de_nominal} shows
the ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
and longitude of periapse difference
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$,
which both settle into equilibrium values after the ringlet arrives at the self-confining
state. In all simulations examined here, the ringlet's periapse twist 
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$ is negative,
so the outer streamline's longitude of periapse $\tilde{\omega}$ trails
the inner streamline's, which in turn causes the streamlines' separations along
the ringlet's pre-periapse side (where $\varphi < 0$) to differ slightly from that int the post-periapse ($\varphi>0$) zone.
Which in turn makes the ringlet's surface density asymmetric, see Fig.\ \ref{fig:radial_sigma_nominal}.

\begin{figure}
\plotone{figs/e_nominal.pdf}
\caption{
\label{fig:e_nominal}
The nominal ringlet's eccentricity evolution.}
\end{figure}

\begin{figure}
    \plotone{figs/de_dwt_nominal.pdf}
    \caption{
        \label{fig:de_nominal}
        The nominal ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
        and longitude of periapse difference
        $\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$
        in radians divided by 10.
    }
\end{figure}

\begin{figure}
    \plotone{figs/nominal_sigma_vs_longitude.pdf}
    \caption{
        \label{fig:nominal_sigma_vs_longitude}
        Nominal ringlet's surface density $\sigma(\varphi)$ versus relative
        longitude $\varphi$ at selected times $t$ and plotted in units of ringlet's initial
        mean surface density $\sigma_0$. Note that the ringlet's surface
        density maxima occurs just before peripase,  and is due to the ringlet's
        negative periapse twist 
        $\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}} < 0$.
    }
\end{figure}

\begin{figure}
    \plotone{figs/radial_sigma_nominal.pdf}
    \caption{
        \label{fig:radial_sigma_nominal}
        Radial profiles of the nominal ringlet's surface density $\sigma(\varphi)$ at time $t/\tau_\nu=100$
        when the ringlet is self-confining. Each surface density profile is plotted versus radial distance $r$ 
        relative to $r_{mid}$, which is the ringlet's midpoint along relative longitude $\varphi = \theta-\tilde{\omega}$,
        with those radial distances $r - r_{mid}$ measured in units of the ringlet's final semimajor axis width $\Delta a$,
        and surface density is shown in units of the ringlet's longitudinally-averaged surface density $\sigma_0$.
        Radial surface density profiles are plotted along the ringlet's periapse ($\varphi=0$, blue curve), which is 
        where the ringlet's streamlines are most concentrated and surface denisity $\sigma$ is
        greatest due to the ringlet's eccentricity gradient $e'$, at the pre-periapse
        quadrature ($\varphi=-\pi/2$, red curve), post-periapse
        quadrature ($\varphi=\pi/2$, green curve)
        and at apoapse ($|\varphi|=\pi$, orange curve) where streamlines have their greatest separation
        and ringlet surface density is lowest. This ringlet's surface density contrast between periapse and
        apoapse is about 14.
    }
\end{figure}

It is convenient to recast these orbit element differences as dimensionless gradients
\begin{equation}
    \label{eqn:e_prime}
    e' = a\frac{de}{da}
    \qquad\mbox{and}\qquad
    \tilde{\omega}' = ea\frac{d\tilde{\omega}}{da}
\end{equation}
as these are the terms that contribute to the nonlinearity parameter of \cite{BGT83}:
\begin{equation}
    \label{eqn:q}
    q = \sqrt{e'^2 + \tilde{\omega}'^2}.
\end{equation}
See also Fig.\ \ref{fig:de_prime_nominal} which plot's the nominal
ringlet's dimensionless eccentricity gradient $e'$, dimensionless periapse twist $\tilde{\omega}'$,
and nonlinearity parameter $q$ versus time. Most of the simulations examined here have
$|\tilde{\omega}'|\ll|e'|$ so that $q\simeq|e'|$ (excepting those
described in Section \ref{subsec:partial}), and all simulated self-confining ringlets
have a positive eccenticity gradient and a negative periapse twist such that
the outer ringlet's periapse trails the inner ringlet's, consistent with the findings of
\cite{BGT83}.\vfil

\begin{figure}
    \plotone{figs/de_prime_nominal.pdf}
    \caption{
        \label{fig:de_prime_nominal}
        The nominal ringlet's dimensionless eccentricity gradient $e' = a\Delta e/\Delta a$
        (blue curve), dimensionless periapse twist $\tilde{\omega}' = ea\Delta\tilde{\omega}/\Delta a$
        (orange), and nonlinearity parameter $q=\sqrt{e'^2 + \tilde{\omega}'^2}$
        (green curve which overlaps blue) versus time $t/\tau_\nu$. Dotted red line 
        is the threshold for self-confinement in a non-gravitating ringlet, $e'=\sqrt{3}/2\simeq0.866$
    }
\end{figure}\vfil


\section{angular momentum and energy fluxes \& luminosities}
\label{sec:fluxes}

The nominal ringlet's evolution is readily understood when the ringlet's 
radial flux of angular momentum and energy are considered. 

\subsection{angular momentum and energy fluxes}
\label{subsec:fluxes}

The torque that is exerted on a small streamline segment of mass $\delta m$
at location $\mathbf{r}=r\hat{\mathbf{r}}$
due to the streamlines orbiting interior to it is $\delta T=\delta m\mathbf{r}\times\mathbf{A}^1$ where 
$\mathbf{A}^1=A^1_r\hat{\mathbf{r}} + A^1_\theta\hat{\boldsymbol\theta}$
is the so-called one-sided acceleration that is exerted on $\delta m$ by the interior streamline. 
Since $\delta m=\lambda\delta\ell$ where $\lambda$ is the streamline's linear mass density,
and $\delta\ell$ is the segment's length, then the radial flux of angular momentum flowing into
that segment due to the accelerations that are exerted by streamlines orbiting interior to that
segment is
\begin{equation}
    \label{eqn:F_L}
    {\cal F}_L(r, \theta) = \frac{\delta T}{\delta\ell} = \lambda r A^1_\theta,
\end{equation}
where $A^1_\theta$ is the tangential component of the one-sided acceleration,
and the streamline's linear mass density $\lambda$ is computed using Eqn.\ (\ref{eqn:lambda}).
The radial angular momentum flux, Eqn.\ (\ref{eqn:F_L}), is due to the ringlet's viscosity and self-gravity,
so ${\cal F}_L = {\cal F}_{L,\nu} + {\cal F}_{L,g}$. 

The work that the interior streamlines exert on $\delta m$ as that segment travels a small distance
$\delta\mathbf{r}=\mathbf{v}\delta t$ in time $\delta t$
is $\delta W=\delta m\mathbf{A}^1\cdot\delta\mathbf{r}$ where 
$\mathbf{v}=v_r\hat{\mathbf{r}} + v_\theta\hat{\boldsymbol\theta}$ is the segment's velocity, and
that work accrues at $\delta m$ at the rate 
$\delta W/\delta t=\lambda\mathbf{A}^1\cdot\mathbf{v}\delta\ell$,
so the radial flux of energy entering that ringlet segment due to accelerations
exerted by the interior streamlines is 
\begin{equation}
    \label{eqn:F_E}
    {\cal F}_E(r, \theta) = \frac{\delta W}{\delta\ell\delta t} = \lambda\mathbf{A}^1\cdot\mathbf{v}.
\end{equation}
The radial energy flux is due to the ringlet's viscosity and self-gravity, so
${\cal F}_E = {\cal F}_{E,\nu} + {\cal F}_{E,g}$. 

\subsection{luminosities}
\label{subsec:luminosities}

The streamline containing segment $\delta m$ has semimajor axis $a$, and 
integrating the radial angular momentum flux ${\cal F}_L$ about the entire streamline
then yields the radial luminosity of angular momentum entering streamline $a$,
\begin{equation}
    \label{eqn:L_L}
    {\cal L}_L(a) = \oint {\cal F}_Ld\ell , 
\end{equation}
which is the torque that is exerted on streamline $a$ by those orbiting interior to it. Similarly,
integrating the radial energy flux ${\cal F}_E$ about streamline $a$ also yields the ringlet's radial energy luminosity
\begin{equation}
    \label{eqn:L_E}
    {\cal L}_E(a) = \oint {\cal F}_Ed\ell,
\end{equation}
which is the rate that the interior streamlines communicate energy to streamline $a$.

\subsection{viscous transport of angular momentum}
\label{subsec:viscous_flux}

Angular momentum is transported radially through the ring via viscosity and self-gravity, 
so ${\cal F}_L={\cal F}_{L,\nu} + {\cal F}_{L,g}$,
where the ringlet's viscous flux of angular momentum is
\begin{equation}
    {\cal F}_{L,\nu}(r, \theta) = -\nu_s \sigma r^2\frac{\partial\omega}{\partial r}
\end{equation}
when Eqn.\ (\ref{eqn:F_nu_theta}) is written as a function of spatial coordinates and
angular velocity $\omega=\dot{\theta}$. 
If we consider a small arc of  ring material of length $d\ell$, 
then ${\cal F}_{L,\nu}d\ell$ is the torque that arc exert exerts on
ring matter just exterior, due to viscous friction,
so that is the rate that friction transmits angular momentum radially across that arc.
And when ${\cal F}_{L,\nu}$ is evaluated along a single eccentric streamline of semimajor axis $a$, 
the above simplifies to
\begin{equation}
    \label{eqn:F_nu_varphi}
    {\cal F}_{L,\nu}(a, \varphi) = {\cal F}_{L,\nu,c}\frac{1-\frac{4}{3}e'\cos\varphi}{(1-e'\cos\varphi)^2}
\end{equation}
where $\varphi=\theta-\tilde{\omega}$ is the longitude relative to periapse
and ${\cal F}_{L,\nu,c}=\frac{3}{2}\nu_s\sigma_0a\Omega$ is the viscous angular momentum flux through a
circular streamline of semimajor axis $a$ and angular speed $\Omega(a)$,
with Eqn.\ (\ref{eqn:F_nu_varphi}) assuming  that
$|\tilde{\omega}'|\ll e'$ so that $q\simeq e'$
(see \citealt{BGT82} and Appendix \ref{sec:Appendix E}). Integrating the above
around the streamline's circumference then yields its angular momentumum luminosity,
\begin{equation}
    \label{eqn:L_nu}
    {\cal L}_{L,\nu}(a) = \oint {\cal F}_{L,\nu}(a, \varphi)rd\varphi = {\cal L}_{L,\nu,c}\frac{1-\frac{4}{3}e'^2}{(1-e'^2)^{3/2}},
\end{equation}
which is the torque that one streamline exerts on its exterior neighbor due to viscous friction
(\citealt{BGT82} and Appendix \ref{sec:Appendix E}),
with ${\cal L}_{L,\nu,c}=3\pi\nu_s\sigma_0a^2\Omega$
being the viscous angular momentum luminosity of a circular streamline.

\citet{BGT82} examine angular momentum transport through a viscous eccentric but non-gravitating ringlet, 
and use Eqns.\ (\ref{eqn:F_nu_varphi}--\ref{eqn:L_nu}) to show that this transport has three 
regimes distinguished by the ringlet's $e'$:

\begin{enumerate}

\item $e'<3/4$. The ringlet's viscous angular momentum flux ${\cal F}_{L,\nu}(\varphi)>0$
at all longitudes $\varphi$. The ringlet's viscous
angular momentum luminosity ${\cal L}_{L,\nu}>0$, so viscous friction transports angular momentum radially outwards,
and the inner ring matter evolves to smaller orbits while exterior ring matter evolves outwards, and
the ringlet spreads radially.

\item $3/4\le e'<\sqrt{3}/2$. In this regime there is a range of longitudes $\varphi$
where the viscous angular momentum flux is reversed such that ${\cal F}_{L,\nu}(\varphi)<0$. 
That angular momentum flux reversal is due to the $\partial\omega/\partial r$
term in Eqn.\ (\ref{eqn:F_nu_theta}) changing sign near periapse when $e'>0.75$, 
see Fig.\ \ref{fig:nominal_shear}.
Nonetheless ${\cal L}_{L,\nu}$, which is proportional to the orbit-average of ${\cal F}_{L,\nu}(\varphi)$,
is positive and the ringlet still spreads radially, albeit slower than when $e'<0.75$.

\item $e'\ge\sqrt{3}/2$. Viscous angular momentum flux reversal is complete such that ${\cal L}_{L,\nu}\le0$,
viscous friction transports angular momentum radially inwards, and the ringlet
shrinks radially. But if $e'=\sqrt{3}/2\simeq0.866$ then ${\cal L}_{L,\nu}=0$ and the ringlet's
radial evolution ceases, and the viscous but non-gravitating ringlet is self--confining.

\end{enumerate}
 
Note though that the nominal ringlet's eccentricity gradient
exceeds the $e'=\sqrt{3}/2\simeq0.866$ threshold 
(dotted red line in Fig.\ \ref{fig:de_prime_nominal}) when it settles into
self-confinement. This is due to the ringlet's self-gravity,
which also transports a flux of angular momentum ${\cal F}_{L,g}$ radially through the ringlet.

Figure \ref{fig:F_nu_nominal} shows the nominal ringlet's viscous angular momentum flux
${\cal F}_{L,\nu}$ versus relative longitude $\varphi=\theta-\tilde{\omega}$ at selected times $t$.
Early in the ringlet's evolution when time $t \le 10\tau_\nu$ (blue, orange, green, red, purple 
and brown curves),
the ringlet is in regime 1 since $e'<0.75$ and ${\cal F}_{L,\nu}(\varphi)>0$ at all longitudes.
But by time $t \ge 20\tau_\nu$ (pink curve), this ringlet's eccentricity gradient exceeds $0.75$,
and angular momentum flux reversal ${\cal F}_{L,\nu}(\varphi)<0$ occurs near periapse where $|\varphi|\simeq0$
where the ringlet is most overdense due to its eccentricity gradient, see 
also Fig.\ \ref{fig:radial_sigma_nominal}.
This ringlet is now in regime 2 and its radial spreading is reduced by angular momentum flux reversal. 
And by time $t = 60\tau_\nu$ (yellow curve), this ringlet is seemingly in regime 3
since $e'>0.866$, so one might expect the ringlet to start contracting
now, but keep in mind that the above analysis ignores any transport
of angular momentum via ringlet self--gravity. Figure \ref{fig:da_nominal} in fact
shows that this gravitating ringlet's spreading had ceased by time $t \simeq80\tau_\nu$, 
at which point $e'=0.88$ (Fig.\ \ref{fig:F_nu_nominal} yellow curve), angular momentum flux reversal is nearly complete,
and the ringlet's total angular momentum luminosity ${\cal L}_L={\cal L}_{L,\nu}+{\cal L}_{L,g}$ is very close to zero.
Figures \ref{fig:angular_momentum_luminosity_nominal} and \ref{fig:angular_momentum_luminosity_zoom_nominal} also show that, 
when the ringlet is self-confining at times $t\ge 80\tau_\nu$, 
its small but positive viscous angular momentum luminosity ${\cal L}_{L,\nu}\simeq0.006{\cal L}_{L,\nu,c}$ 
is counterbalanced by its negative gravitational angular momentum luminosity ${\cal L}_{L,g}\simeq -0.006{\cal L}_{L,\nu,c}$,
so radial spreading has ceased and the ringlet is self-confining. 

\begin{figure}
    \plotone{figs/nominal_shear.pdf}
    \caption{
        \label{fig:nominal_shear}
        The nominal ringlet's angular shear $\partial\omega/\partial r$ is plotted versus relative 
        longitude $\varphi$ at selected moments in time; this quantity is negative where the inner streamline
        has the higher angular speed $\omega=v_\theta/r$. When the simulation starts, the
        ringlet has eccentricity $e=0.01$ and eccentricity gradient $e'=0$ 
        so $\partial\omega/\partial r\simeq-3\Omega/2r\simeq-1.5$ when evaluated natural units (blue curve).
        The ringlet's $e'$ then grows over time (orange, green, red curves),
        which reverses the sign of $\partial\omega/\partial r$
        near periapse when $e'>0.75$; here the inner ringlet's angular speed
        is slower than the outer ringlet, and viscous friction causes angular momentum to instead flow inwards
        at these longitudes. Dashed curve is Eqn.\ (\ref{eqn:domega-dr}) with $e'=\sqrt{3}/2$
        and assuming $|\tilde{\omega}'|\ll1$.
    }
\end{figure}

\begin{figure}
    \plotone{figs/F_nu_nominal.pdf}
    \caption{
        \label{fig:F_nu_nominal}
        The nominal ringlet's viscous angular momentum flux ${\cal F}_{L,\nu}(\varphi)$,
        Eqn.\ (\ref{eqn:F_nu_varphi}), is plotted 
        in units of ${\cal F}_{L,\nu,c}$ (the angular momentum flux in a circular ringlet)
        and versus the ringlet's
        relative longitude $\varphi=\theta-\tilde{\omega}$ at selected times $t/\tau_\nu$, 
        with the ringlet's eccentricy gradient $e'$ also indicated.
    }
\end{figure}

\begin{figure}
    \plotone{figs/angular_momentum_luminosity_nominal.pdf}
    \caption{
        \label{fig:angular_momentum_luminosity_nominal}
        Nominal ringlet's viscous angular momentum luminosity ${\cal L}_{L,\nu}$ (blue curve) versus time $t/\tau_\nu$
        and in units of a circular ring's viscous angular momentum luminosity ${\cal L}_{L,\nu,c}$, 
        as well as the ringlet gravitational angular momentum luminosity ${\cal L}_{L,g}$ (orange curve).
    }
\end{figure}

\begin{figure}
    \plotone{figs/angular_momentum_luminosity_zoom_nominal.pdf}
    \caption{
        \label{fig:angular_momentum_luminosity_zoom_nominal}
        Figure \ref{fig:angular_momentum_luminosity_nominal} is replotted to show that the ringlet's 
        viscous angular momentum luminosity ${\cal L}_{L,\nu}$ (blue curve)
        always stays positive (indicating that the viscous transport of angular momentum is radially outwards)
        and is eventually balanced by the ringlet's negative ({\it i.e.}\ inwards) gravitational angular momentum luminosity 
        ${\cal L}_{L,g}$ (orange) after time $t\ge 80\tau_\nu$. Green curve is total angular momentum luminosity 
        ${\cal L}_{L,\nu} + {\cal L}_{L,g}$ whose time-average is zero when $t\ge 80\tau_\nu$.
        Dashed lines are $\pm0.006{\cal L}_{L,\nu,c}$.
    }
\end{figure}

\begin{figure}
    \plotone{figs/F_vs_longitude_nominal.pdf}
    \caption{
        \label{fig:F_vs_longitude_nominal}
        The nominal ringlet's viscous angular momentum flux ${\cal F}_{L,\nu}(\varphi)$ (blue curve) is computed
        via Eqn.\ (\ref{eqn:F_nu_theta}) and plotted in units of a circular ringlet's flux ${\cal F}_{L,\nu,c}$
        versus relative longitude $\varphi$ at the simulation's end time $t=100\tau_\nu$, 
        as well as the ringlet's gravitational angular momentum flux ${\cal F}_{L,g}(\varphi)$
        (orange curve via Eqn.\ \ref{eqn:F_L}).
    }
\end{figure}


\subsection{gravitational transport}
\label{subsec:gravitational_flux}

The nominal ringlet's viscous ${\cal F}_{L,\nu}$ and gravitational ${\cal F}_{L,g}$
angular momentum fluxes are shown Fig.\ \ref{fig:F_vs_longitude_nominal} after it has settled into the self-confining state. 
That figure shows how viscous friction tends to transport angular momentum radially inwards, ${\cal F}_{L,\nu}(\varphi)<0$, 
at longitudes nearer periapse where $|\varphi|\sim0$, and outwards
at all other longitudes, with that flux reversal being due to the
reversal of the ringlet's angular velocity gradient, Fig.\ \ref{fig:nominal_shear}. 
Figure \ref{fig:F_vs_longitude_nominal} also shows that the ringlet's gravitational
transport of angular momentum is inwards as
ring-matter approaches periapse where $\varphi<0$, 
and is outwards ${\cal F}_{L,g}(\varphi)>0$ post-periapse, with that asymmetry being due to the ringlet's
negative periapse twist, $\tilde{\omega}'<0$ (Fig.\ \ref{fig:de_prime_nominal}).

Figure \ref{fig:nominal_energy_flux} shows the ringlet's energy fluxes 
due to viscosity (blue curve) and gravity (orange) at simulation end.
Integrating these fluxes about a streamline's circumference at various times $t$ then yields the
the ringlet's viscous ${\cal L}_{E,\nu}$ and gravitational energy luminosity ${\cal L}_{E,g}$ over time,
Fig.\ \ref{fig:nominal_energy_luminosity}, where the gravitational energy luminosity is computed via
\begin{equation}
    \label{eqn:L_g}
    {\cal L}_{E,g}(a) = \oint {\cal F}_{E,g}(\varphi)rd\varphi = \oint \lambda r\mathbf{A}^1_g\cdot\mathbf{v}d\varphi
\end{equation}
where $\mathbf{A}^1_g$ is the one-sided gravitational acceleration experienced by a particle in streamline $a$.
Note that even though ${\cal F}_{E,\nu}$ and ${\cal F}_{E,g}$ have very different spatial dependances 
(see Fig.\ \ref{fig:nominal_energy_flux}),
the influence of the ringlet's viscosity and gravity still conspire such that their
orbit-integrated luminosities ${\cal L}_{E}=\oint ({\cal F}_{E,\nu}+{\cal F}_{E,g})rd\varphi$ are zero 
once the ringlet has settled into the self-confining state.

Note that Fig.\ \ref{fig:nominal_energy_luminosity} also shows that 
the ringlet's gravitational energy luminosity is zero. Which is to be expected since 
the streamlines' gravitating ellipses only interact via their secular
perturbations, and secular perturbations do no work \citep{BC61}, hence ${\cal L}_{E,g}=0$.
That this quantity evaluates to zero within $\pm5\times10^{-24}$ (in nautural units) can also be regarded
as another test of the epi\_int\_lite integrator's numerical quality.


\begin{figure}
    \plotone{figs/F_energy_vs_longitude_nominal.pdf}
    \caption{
        \label{fig:nominal_energy_flux}
        Blue curve is the nominal ringlet's viscous energy flux ${\cal F}_{E,\nu}(\varphi)$, plotted 
        in units of a circular ringlet's viscous energy flux ${\cal F}_{E,\nu,c}$ 
        and versus the ringlet's relative longitude $\varphi$ at the simulation's end time $t=100\tau_\nu$, 
        as well as the ringlet's gravitational energy flux ${\cal F}_{E,g}(\varphi)$.
    }
\end{figure}

\begin{figure}
    \plotone{figs/nominal_energy_luminosity.pdf}
    \caption{
        \label{fig:nominal_energy_luminosity}
        Nominal ringlet's viscous energy luminosity ${\cal L}_{E,\nu}$ (blue curve) versus time $t/\tau_\nu$
        and in units of a circular ring's viscous energy luminosity ${\cal L}_{E,\nu,c}$, 
        as well as the ringlet gravitational energy luminosity ${\cal L}_{E,g}$ (orange curve).
    }
\end{figure}


\subsection{variations with ringlet width, mass, and viscosity}
\label{subsec:variations}

To assess whether the nominal ringlet's evolution is typical of other ringlets
having alternate values of initial width $\Delta a$, total mass $m_r$, and shear viscosity $\nu_s$,
a survey of 467 additional ringlet simulations are executed. 
These survey ringlets are similar to the nominal ringlet 
with $N_s=2$ streamlines having $N_p=241$ particles per streamline, initial 
eccentricity $e=0.01$, initial eccentricity gradient $e'=0$, and viscosities $\nu_b=\nu_s$. 
But the survey ringlets instead have
total masses that are geometrically distributed between $10^{-13}\le m_r\le10^{-9}$,
shear viscosities distributed between $10^{-15}\le \nu_s\le 10^{-11}$,
and initial radial widths distributed between  
$2.5\times10^{-5}\le \Delta a\le2.0\times10^{-4}$. Survey results are summarized in Fig.\ \ref{fig:sim_grid_da}
where circles indicate those ringlets that do evolve into a self-confining state.
All simulations of self-confining ringlets are evolved in time until 
$10\tau_{dyn}$ where the so-called dynamical time $\tau_{dyn}$ is the moment when
the ringlet's nonlinearity parameter $q$ first exceeds $0.6$, since Fig.\ \ref{fig:de_prime_nominal}
suggests that $10\tau_{dyn}$ is sufficient time to assess whether the ringlet
has truly arrived at the self-confining state. 

\begin{figure}
    \gridline{\fig{figs/sim_grid_da_0p000025.pdf}{0.5\textwidth}{}\fig{figs/sim_grid_da_0p00005.pdf}{0.5\textwidth}{}}
    \gridline{\fig{figs/sim_grid_da_0p0001.pdf}{0.5\textwidth}{}\fig{figs/sim_grid_da_0p0001.pdf}{0.5\textwidth}{}}
    \gridline{\fig{figs/sim_grid_da_0p0002.pdf}{0.7\textwidth}{}}
    \caption{
        \label{fig:sim_grid_da}
        Outcomes for 468 ringlet simulations having a variety of ringlet
        masses $m_r$ and shear viscosities $\nu_s$, with each panel showing results
        for those ringlets having the same initial radial width
        $\Delta a=2.5\times10^{-5}$, $5\times10^{-5}$, $1\times10^{-4}$, or $2\times10^{-4}$. Circles 
        indicate those ringlets that evolve into the self-confining state, while an $\times$ is
        for those simulations that terminate early when an epi\_int\_lite particle crossed an adjacent streamline,
        and N indicates the nominal ringlet simulation. The color of each self-confining ringlet shows
        whether the ringlet settled into a high--eccentricity gradient state with $e'> 0.86$ (blue),
        or smaller eccentricity gradients $0.4>e'>0.86$ (cyan), $0.06>e'>0.4$ (green), or $e<0.06$ (yellow)
        with these intervals chosen so that there are approximately 50 simulations in each color-bin.
        All simulations are evolved for the greater of ten dynamical timescales $\tau_{dyn}$, 
        or ten viscous timescales $10\tau_{\nu}$.
        The middle-right plot is redundant and is here to trick latex into rendering all plots on same page, please ignore.
    }
\end{figure}

The $\times$ simulations in Fig.\ \ref{fig:sim_grid_da}
terminated early when an epi\_int\_lite particle crossed a 
neighboring streamline. In reality, strong 
pressure forces would have developed as adjacent streamlines converged
and enhanced particle densities and particle collisions, with ring particles
possibly rebounding off this high-density region and/or splashing vertically,
none of which is accounted for with this version of epi\_int\_lite. 
So this survey simply terminates all such simulations and flags that occurrence with an 
$\times$ in Fig.\ \ref{fig:sim_grid_da}. Keep in mind though that this does not mean
that these particular ringlets would not evolve into a self-confining state. Instead,
the streamlines in these ringlets have evolved so close to each other that a more sophisticated
and possibly nonlinear treatment of pressure effects is needed 
to accurately assess these ringlets' fates.

Each circle in Fig.\ \ref{fig:sim_grid_da} represents a self-confining ringlet whose
nonlinearity parameter settles into a value that is close to the anticipated value, $q\simeq0.9$.
But these self-confining ringlets' final eccentricity gradients $e'$ also settle 
into a spectrum of values, $0\le e' \le 0.9$, with
outcomes indicated by circle color in Fig.\ \ref{fig:sim_grid_da}:
blue for a high--eccentricity gradient ringlets having 
$e'> 0.86$, cyan for smaller eccentricity gradients $0.4>e'>0.86$, green for $0.06>e'>0.4$ (green),
and yellow for very low eccentricity gradients $e<0.06$,
with these intervals chosen so that there are approximately 50 simulations in each color-bin.
Fig.\ \ref{fig:e_prime_q_vs_time} how eccentricity gradient varies over time $t/\tau_{dyn}$
for a sample of  self-confining ringlet simulations. That Figure also shows 
that the range of simulation $e'$ outcomes also agrees with the 
range of eccentricity gradients observed among Saturn's most well-studied narrow eccentric
ringlets, the Maxwell, Titan, Laplace, and Huygens ringlets, whose $e'$ are
indicated by the black horizontal lines in Fig.\ \ref{fig:e_prime_q_vs_time}.

Also keep in mind that Fig.\ \ref{fig:e_prime_q_vs_time} is not an apples-to-apples comparison 
of simulated ringlets to observed ringlets, since no attempt is made here to match
the observed ringlet's semimajor-axis width $\Delta a$ to the simulated ringlet's final $\Delta a$.
Rather,  Fig.\ \ref{fig:e_prime_q_vs_time}'s main point is that the observed range of ringlet
eccentricity gradient can be accounted for by this model of a viscous self-gravitating ringlet
that is also self-confining.
And lastly, recall that $q=\sqrt{e'^2 + \tilde{\omega}'^2}$ which tells us that lower eccentricity gradient
ringlets have a larger periapse twist $|\tilde{\omega}'|$.

\begin{figure}
    \plotone{figs/e_prime_selected.pdf}
    \caption{
        \label{fig:e_prime_q_vs_time}
        Eccentricity gradient $e'$ versus time $t/\tau_{dyn}$ for a sample of self-confining
        ringlets selected from those seen Fig.\ \ref{fig:sim_grid_da} such
        that their eccentricity gradients $e'$ span the range of values observed among the
        Maxwell, Titan, Laplace, and Huygens ringlets at Saturn whose $e'$ values
        are indicated by horizontal black lines (references). Each curve ends with that
        simulation's ID, and that ID is also indicated in Fig.\ \ref{fig:sim_grid_da}.
        Dotted line is the $e'=\sqrt{3}/2$ threshold.
        Todo: show Epsilon ringlet, add IDs to Fig 15, and do additional simulations to populate down
        to the Huygens' $e'$.  
    }
\end{figure}


\subsubsection{variations with ringlet viscosity}
\label{subsec:viscosity-variations}

Figure \ref{fig:wt_prime_vs_time} shows the periapse twist $\tilde{\omega}' \simeq ea\Delta\tilde{\omega}/\Delta a$ 
versus time for five ringlets
having the same initial $e_0$, $\Delta a$, and $m_r$ as the nominal ringlet but differing viscosities $\nu_s$, and
that plot shows that twist $|\tilde{\omega}'|$ varies with $\nu_s$. Which indicates that if 
the twist $|\tilde{\omega}'|$ could be observed in a self-confining ringlet, then 
the ringlet's viscosity could then be inferred. 

\begin{figure}
    \plotone{figs/wt_prime_vs_time.pdf}
    \caption{
        \label{fig:wt_prime_vs_time}
        Periapse twist $\tilde{\omega}'$ is plotted versus time $t/\tau_\nu$ for five ringlets
        having the same initial $e_0$, $\Delta a$, $m_r$ as the nominal ringlet (whose simulation ID=345)
        but differing viscosities $\nu_s$ that range over $0.5\nu_n\le\nu_s\le2\nu_n$
        where $\nu_n=2.5\times10^{-12}$ is the nominal ringlet's shear visocity.
    }
\end{figure}


\subsubsection{variations with initial radial width}
\label{subsec:width-variations}

blah

\subsubsection{variations with initial eccentricity}
\label{subsec:e-variations}

Additional simulations are used to assess how outcomes depend upon the ringlet's initial eccentricity $e_0$.
Figure \ref{fig:e0} shows seven simulations of the nominal ringlet that all have identical
physical properties (mass, initial width $\Delta a$) but differing initial $e_0$ ranging
over $0\le e_0\le 0.025$, and two types of outcomes are observed. Higher $e_0$ simulations having $e_0\gtrsim0.005$ 
evolve into the self-confining state with $q\simeq\sqrt{3}/2$ and constant width $\Delta a$
(e.g.\ the lower purple, brown and dark-blue curves). However 
lower $e_0\lesssim0.005$ (red, green, orange) simulations are only 
are partially self--confining in that self-gravity does not pump up the ringlet's $q$
sufficient for self-confinement, so these simulated ringlet's $\Delta a$ spreads radially
albeit slower than the circular ringlet (uppermost blue curve).
This bifurcated outcome suggest that the nominal ringlet has a
separatrix that divides true self-confinement (which requires $e_0\gtrsim0.005$) from partial or no
confinement. This in turn suggests that the partially confined ringlet's (pink diamonds) seen in
Fig.\ \ref{fig:sim_grid_da} might instead have achieved 
true confinement had they started with sufficiently high initial $e_0$.

\begin{figure}
    \plotone{figs/e0.pdf}
    \caption{
        \label{fig:e0}
        Simulations of seven nominal ringlets having a variety of initial eccentricities $0\le e_0\le 0.025$.
        Plot shows each ringlet's semimajor axis width $\Delta a$ in units of its initial $\Delta a_0$
        versus time $t/\tau_\nu$, and simulations having higher initial $e_0\gtrsim0.005$ 
        (lower purple, brown and dark-blue curves) evolve into the self-confining state
        with nonlinearity parameter $q\simeq\sqrt{3}/2$. Ringlets having lower initial $e_0\lesssim0.005$
        (red, green, and orange curves) are partially self-confining, while the $e_0=0$ ringlet (upper blue curve)
        is always unconfined and experiences fastest radial spreading.
    }
\end{figure}

Section \ref{subsec:eccentricity} will derive the rate at which
a self-confining ringlet's eccentricity $e$ decays over time due to viscosity, Eqns.\ (\ref{eqn:de2/dt_v2}--\ref{eqn:e(t)}),
and all ringlets shows in Figs.\ \ref{fig:low_libration_sims}--\ref{fig:e_prime_q_vs_time},
which includes fully as well as partially self-confining ringlets, all have eccentricities $e$
that decay at the expected rates.


\subsection{eccentricity damping}
\label{subsec:eccentricity}

Viscous friction within the ringlet is a result of dissipative collisions among ringlet particles.
Particle collisions generate heat that is radiated into space, and the source of that radiated energy
is the ringlet's orbital energy $E_r=-m_rGM/2a + E_{sg}$ where $m_r$ is the ringlet's total
mass, $a$ its semimajor axis, and $E_{sg}$ is the ringlet's energy due to its self gravity
which is contant when the ringlet is self-confining. 
Collisions conserve angular momentum, so the ringlet's total angular momentum
$L_r=m_r\sqrt{GMa(1-e^2)}$ is constant so $dL_r/dt=0$ implies
\begin{equation}
    \label{eqn:e2-dot}
    \frac{de^2}{dt} \simeq \frac{1}{a}\frac{da}{dt}
\end{equation}
to lowest order in the ringlet's small eccentricity $e$.
The ringlet's energy dissipation rate is $\dot{E}_r = dE_r/dt=m_rGM\dot{a}/2a^2$ so
$\dot{a}\simeq2\dot{E_r}/m_ra\Omega^2$ and 
\begin{equation}
    \label{eqn:de2/dt}
    \frac{de^2}{dt} \simeq \frac{2\dot{E_r}}{m_r a^2\Omega^2}
\end{equation}
where $GM\simeq a^3\Omega^2$ to lowest order in $J_2$. Also note that
the surface area of energy dissipation within a viscous disk is
\begin{equation}
    \delta = -\nu_s\sigma(r\omega')^2
\end{equation}
(\citealt{P81} I think) where $\omega=v_\theta/r$ is the angular velocity and 
$\omega'=\partial\omega/\partial r$ its radial gradient.

Now consider a small tangential segment within the ringlet whose length is $d\ell=rd\varphi$ where 
$\varphi$ is the segment's longitude measured from the ringlet's periapse and
$d\varphi$ is the small segment's angular extent. The segment's area is 
$dA=\Delta rd\ell=r\Delta r d\varphi$
where $\Delta r$ is the ringlet's radial width.
The rate at which that patch's viscosity dissipates orbital energy is $d\dot{E_r}=\delta dA$, so
the ringlet's total energy dissipation rate is 
$\dot{E}_r = \oint d\dot{E_r}$ when integrated about the ringlet's circumference, and so
$\dot{E}_r = -2\nu_s\lambda\int_0^\pi r^3\omega'^2d\varphi$
since the ringlet's linear density $\lambda=\sigma\Delta r\simeq m_r/2\pi a$. So the
total energy loss rate due to ringlet viscosity becomes
\begin{equation}
    \label{eqn:dE_r/dt}
    \dot{E}_r \simeq -\frac{9}{4}I(e')m_r\nu_s\Omega^2
\end{equation}
when Eqn.\ (\ref{eqn:domega-dr}) is used to replace $\omega'$, and the integral 
\begin{equation}
    I(e') =  \frac{1}{\pi}\int_0^\pi\left(\frac{1-\frac{4}{3}e'\cos\varphi}{1-e'\cos\varphi}\right)^2d\varphi .
\end{equation}
Note that  $I(e')$ is of order
unity except when $e'$ is very close to 1, and numerical evaluation shows that $I(e')\simeq0.889$
when $e'=\sqrt{3}/2$.

Inserting Eqn.\ (\ref{eqn:dE_r/dt}) into (\ref{eqn:de2/dt}) then yields the rate at which $e^2$
is damped,
\begin{equation}
    \label{eqn:de2/dt_v2}
    \frac{de^2}{dt} = -\frac{9I\nu_s}{2a^2}
\end{equation}
which is easily integrated to obtain
\begin{equation}
    \label{eqn:e(t)}
    e(t) = e_0\sqrt{1-\frac{t}{\tau_e}}
\end{equation}
where $e_0$ is the ringlet's initial eccentricity and
\begin{equation}
    \label{eqn:tau_e}
    \tau_e = \frac{2a^2e_0^2}{9I\nu_s}
\end{equation}
is the ringlet's eccentricity damping timescale.
These expectations are also confirmed in Fig.\ \ref{fig:e_vs_tau_e}, which plots
$e(t)/e_0$ versus time $t/\tau_e$ using Eqns.\ (\ref{eqn:e(t)}--\ref{eqn:tau_e}),
for each of the numbered simulations seen in Figs.\ \ref{fig:sim_grid_da}--\ref{fig:q_vs_ID},
with good agreement seen between theory and numerical simulation.
\begin{figure}
    \plotone{figs/e_vs_tau_e.pdf}
    \caption{
        \label{fig:e_vs_tau_e}
        Plot of $e(t)/e_0$ versus time $t/\tau_e$ for each of the 
        numbered simulations seen in Figs.\ \ref{fig:sim_grid_da}--\ref{fig:q_vs_ID},
        while the dashed curve is the expected behavior, Eqn.\ (\ref{eqn:e(t)}).
        These simulations have values of $\tau_e$ ranging over...,
        and thick red curve is the nominal ringlet whose ID=345.
    }
\end{figure}

So viscosity circularizes the ringlet in time $\tau_e$, during which time the ringlet's
semimajor axis will have shrunk by $\Delta a=\dot{a}\tau_e=-e_0^2a$ by Eqns (\ref{eqn:e2-dot})
and (\ref{eqn:de2/dt_v2}), so the ringlet's
fractional drift inwards due to viscous damping is
\begin{equation}
    \label{eqn:delta-a}
    \frac{\Delta a}{a} = -e_0^2,
\end{equation}
which is small. And after the ringlet's inner edge damps to zero, its eccentricity gradient $e'$
will then shrink over time, angular momentum flux reversal will diminish, and the ringlet's 
viscous spreading will resume. So self-confinement of narrow eccentric ringlets is only temporary
after all, until time $\tau_e$ has elapsed, which is $\tau_e/2\pi\sim1.6\times10^6$ orbits for 
the nominal model considered here, which is only $\sim10^3$ years for a ringlet orbiting at 
$a\sim10^{10}$ cm about Saturn. Recall from Section \ref{subsec:nominal}
that the viscous lifetime of a non-self-confining
nominal ringlet is only $\tau_\nu/2\pi\sim500$ orbits, so self-confinement evidently
extends the lifetime of a narrow eccentric ringlet by factor of $\sim3000$. But self-confinement
does not solve the ringlet's lifetime problem, because self-confinement is ultimately
defeated by viscous damping of the ringlet's eccentricity.


\subsection{number of streamlines $N_s$}
\label{subsec:num_streamlines}

When the simulated ringlet is composed of $N_s=2$ streamlines, the ringlet's
evolution is largely analytic ({\it c.f.}\ \citealt{BGT82, BGT83}), and those analytic
predictions also provide excellent benchmark tests for the epi\_int\_lite integrator. This subsection 
assesses whether the results obtained for the simpler $N_s=2$ ringlet also applies to
more realistic ringlets having $N_s>2$.

Figures \ref{fig:a_versus_t_streamlines}--\ref{fig:wt_vs_da_streamlines} recompute the nominal
ringlet's evolution but for ringlets having a range of streamlines, $2\le N_s\le31$. 
Figure \ref{fig:a_versus_t_streamlines} shows that ringlets having larger $N_s$
also achieve larger semimajor axis widths $\Delta a = a_{outer} - a_{inner}$. Figure  
\ref{fig:e_vs_da_streamlines} plots each streamlines' final eccentricities $e$
versus their final $\Delta a$, and this plot shows
that all curves have the same $e$ versus $\Delta a$ slope
{\it i.e.}\ all simulated ringlets have the same eccentricity gradient regardless of 
number of streamlines $N_s$. Ditto for $\tilde{\omega}$ versus $\Delta a$, 
Fig.\ \ref{fig:wt_vs_da_streamlines}.
Consequently, the evolution of the simulated ringlets
nonlinearity parameter $q$, which depends on those gradients via Eqn.\ (\ref{eqn:q}), and also
controls how viscosity communicate angular momentum between
the streamlines [e.g.\ Eqn.\ (\ref{eqn:L_nu}) 
and note that $q\simeq e'$ in all simulations considered here], 
is very similar over time for various $N_s$, see Fig.\ \ref{fig:q_versus_t_streamlines}.
The only noteworthy difference between the $N_s=2$ ringlet and the higher $N_s$
ringlets is seen in Fig.\ \ref{fig:wt_vs_da_streamlines}, which 
which shows that the $N_s>2$ ringlets have an outer longitude of peripase that trails
the inner streamline by a factor of $\sim2$. Except for this one distinction,
the evolution of the $N_s>2$ ringlets is very similar to that exhibited by nominal
ringlet composed of $N_s=2$ streamlines 
\begin{figure}
    \plotone{figs/a_versus_t_streamlines.pdf}
    \caption{
        \label{fig:a_versus_t_streamlines}
        The nominal ringlet simulation is repeated for ringlets composed of $N_s=2,5,9,13,21,31$ streamlines
        as indicated by the legend, with all other parameters are identical to that used in Fig.\ \ref{fig:a_nominal}.
        Plot shows how the simulated ringlets' semimajor axis width $\Delta a = a_{outer} - a_{inner}$
        evolve over time $t$ in units of the nominal ringlet's viscous timescale $\tau_\nu$.
    }
\end{figure}
\begin{figure}
    \plotone{figs/e_vs_da_streamlines.pdf}
    \caption{
        \label{fig:e_vs_da_streamlines}
        Simulated ringlets' final eccentricities $e$ are plotted versus their final
        semimajor axis displacement $\Delta a=a-\bar{a}$ where $\bar{a}$ is the mean semimajor
        axis of all particles in each ringlet.
    }
\end{figure}
\begin{figure}
    \plotone{figs/wt_vs_da_streamlines.pdf}
    \caption{
        \label{fig:wt_vs_da_streamlines}
        $\tilde{\omega} = \tilde{\omega}_{outer} - \tilde{\omega}_{inner}$
    }
\end{figure}
\begin{figure}
    \plotone{figs/q_versus_t_streamlines.pdf}
    \caption{
        \label{fig:q_versus_t_streamlines}
        Caption...
    }
\end{figure}


\subsubsection{partially confined ringlets}
\label{subsec:partially_confined}

text...

\section{ringlet origin scenarios}
\label{sec:origin}

text...

\section{summary of findings}
\label{sec:summary}

Main findings:

\begin{enumerate}

\item Simulations show that narrow eccentric ringlets having a wide variety of initial 
physical properties (mass, initial width, viscosity) do evolve
into the self-confining state (see Fig.\ \ref{fig:sim_grid_da}), 
provided that the ringlet's initial eccentricity is sufficiently high (Section \ref{subsec:e-variations}). 
Self-gravity causes the ringlet's eccentricity gradient $e'$ to grow over time until they near the
$\simeq e'\simeq\sqrt{3}/2\simeq0.866$ threshold where viscous angular momentum flux
reversal is nearly complete and there is {\em almost} no radial orbit-averaged
transmission of angular momentum due to the ringlet's viscous friction.

Simulations also show that these self-confining ringlets all have a small 
periapse twist $|w'|\ll e'$ so that the
ringlet's nonlinearity parameter is dominated by their eccentricity gradient
$q=\sqrt{e'^2 + \tilde{\omega}'^2}\simeq e'$.

\item Self confining ringlets have $L_E=0$

\item partial self confinement

\end{enumerate}


\section{followup studies}
\label{sec:followup}

Possible followup studies...

\acknowledgments
\section{Acknowledgments}
\label{sec:Acknowledgments}

This research was supported by the National Science Foundation via Grant No.\ AST-1313013.


\appendix

\section{Appendix A}
\label{sec:Appendix A}

Derive the more accurate drift step used by epi\_int\_lite...

Show that angular velocity $\omega=v_\theta/r\simeq\Omega(1+2e\cos M)$ to
first order in $e$. Then show that
\begin{equation}
    \label{eqn:domega-dr}
    \omega' = \frac{d\omega}{dr} \simeq -\left(\frac{3\Omega}{2a}\right)
        \frac{1-\frac{4}{3}e'\cos M}{1-e'\cos M}
\end{equation}
to lowest order in $e$ where mean anomaly $M\simeq\theta-\tilde{\omega}$.

Show that the streamline's linear density is
\begin{equation}
    \label{eqn:lambda}
    \lambda = \frac{m_1\Omega}{2\pi v}
\end{equation}
where $m_1 = m_r/N_r$ is the mass of a single streamline.

\section{Appendix B}
\label{sec:Appendix B}

Compare epi\_int\_lite to theoretical predictions

\section{Appendix D}
\label{sec:Appendix D}

This examines the viscous evolution of a narrow eccentric non-gravitating
ringlet that is identical to the nominal ringlet of Section \ref{subsec:nominal} but
with ringlet self-gravity neglected and $J_2=0$.
As the orange curve in Fig.\ \ref{fig:da_nogravity} shows, the non-gravitating ringlet's
radial width $\Delta a$ grows steadily over time due to ringlet viscosity, 
long after the nominal self-gravitating ringlet (blue curve)
has settled into the self-confining state by time $t\sim15\tau_\nu$. This is due to the
ringlet's secular gravitational perturbations of itself,
which tends to excites the ringlet's outer streamline's eccentricity at the expense
of the inner streamline (see Fig.\ \ref{fig:e_nominal}) until the ringlet eccentricity gradient $e'$
(blue curve in Fig.\ \ref{fig:de_prime_nogravity}) grows beyond the
limit required for complete angular momentum flux reversal 
that results in the ringlet's radial confinement (dotted line). 
Note that viscosity also excites the non-gravitating
ringlet's eccentricity gradient some (orange curve), but not sufficiently to halt the ringlet's 
viscous spreading.

\begin{figure}
    \plotone{figs/da_nogravity.pdf}
    \caption{
        \label{fig:da_nogravity}
        Blue curve is the nominal ringlet's semimajor axis width $\Delta a$ versus time $t$,
        and this ringlet's radial spreading ceases by time $t\sim15\tau_\nu$ when it's self-gravity
        has excited the ringlet's eccentricity gradient $e'$ sufficiently; 
        see blue curve in Fig.\ \ref{fig:de_prime_nogravity}. Orange curve shows that
        the non-gravitating ringlet's $\Delta a$ grows without limit due to the ringlet's
        much lower eccentricity gradient. Note that planetary oblateness would
        cause the non-gravitating streamlines to precess differentially and eventually cross
        when $J_s>0$, so the non-gravitating simulation also sets $J_2=0$ 
        to avoid differential precession.
    }
\end{figure}

\begin{figure}
    \plotone{figs/de_prime_nogravity.pdf}
    \caption{
        \label{fig:de_prime_nogravity}
        blah
    }
\end{figure}

\section{Appendix E}
\label{sec:Appendix E}

This Appendix will use the orbit elements derived in Appendix \ref{sec:Appendix A} to
derive Eqn.\ \ref{eqn:F_nu_varphi} from \ref{eqn:F_nu_theta}, and then Eqn.\ (\ref{eqn:L_nu}).

\section{Appendix F}
\label{sec:Appendix F}

Viscous and gravitational energy transport...


\bibliography{jmh_bibliography}
\end{document}


\end{document}




\section{Trash}


\subsection{improved drift step around oblate planet}
\label{subsec:drift}


\subsection{kick}
\label{subsec:kick}



Epi\_int is a drift-kick integrator, and such integrators alternate between drifting
(ie advancing) a particle along its unperturbed trajectory, with each drift followed
by a velocity kick that accounts for all other perturbing forces such as ring self gravity
and ring viscosity. Drifting a particle efficiently along its unperturbed trajectory around
an oblate planet requires an analytic
expression for that trajectory, and epi\_int utilized the \cite{BL94} solution
that requires, at every timestep, the conversion of the particle's spatial coordinates
and velocities into geometric orbit elements, with the drifted particle's
orbit elements then converted back to spatial coordinates every timestep. That conversion is accurate
to order ${\cal O}(e^2)$ where $e$ is the particle's geometric eccentricity, but the
conversion from spatial coordinates to orbit elements and back is not reversible, which
means that the drifted particle's trajectory acquires an ${\cal O}(e^3)$ error
every timestep. Although the accumulation of this error was too slow to significantly impact
epi\_int's B ring simulations spanning $10^4$ orbit periods, this error does preclude 
using that code to simulate the much slower viscous evolution of ringlets over $10^6$ orbit periods.

To avoid this accumulation of drift errors, Section \ref{sec:drift-kick} derives an alternate set of geometric
orbit elements that describe the particle's unperturbed motion around an oblate planet. Note though
the conversion of spatial coordinates to the new geometric orbit elements is exact
and reversible, and so epi\_int\_lite's drift step is not a significant source of error. 

The chief principal guiding the developement of epi\_int\_lite is that the code be
accurate to solve the problem at hand while also being as simple
as possible so that the code can be developed, tested, and executed as swiftly as possble.
With this in mind, several simplifying approximations are made and are detailed
below in Section \ref{subsec:approximations} and they simplify code development and
shorten run times significantly. Section \ref{sec:testing} then assesses the impact
of those approximations, and shows that they are truly negligable and do not affect outcomes
or conclusions.

Although the epi\_int integrator was well-suited for evolving the
B ring edge over the $\sim3\times10^4$ orbits needed to monitor the B ring's response to Mimas
perturbations, that code lacked sufficient numerical accuracy to evolve a ringlet
during the $\sim3\times10^6$? orbits needed to track its slow radial spreading due to ringlet viscosity.
That inability was traced to epi\_int's drift step, and Section ? describes
how that is mitigated in the new code.
