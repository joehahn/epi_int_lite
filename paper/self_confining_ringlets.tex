%self_confining_ringlets.tex
%
%by Joe Hahn et al, jhahn@spacescience.org, 20 November 2018.
%
%draft ApJ paper on epi_int_lite simulations of self confining ringlets.
%
%to compile:
%    pdflatex self_confining_ringlets
%    bibtex self_confining_ringlets
%    pdflatex self_confining_ringlets


\documentclass[preprint]{aastex62}

%bibliography, see
%http://ads.harvard.edu/pubs/bibtex/astronat/doc/html/astronat_3.html
\usepackage{natbib}
%\citestyle{aa}

%journal
\received{not yet}
\revised{not yet}
\accepted{not yet}
\submitjournal{Somewhere, eventually}

%short names
\shorttitle{Narrow Eccentric Ringlets}
\shortauthors{Hahn et al.}


\begin{document}


%title page
\title{N-body simulations of the Self--Confinement of 
Viscous Self--Gravitating Narrow Eccentric Planetary Ringlets}

\correspondingauthor{Joseph M. Hahn}
\email{jhahn@spacescience.org}

\author{Joseph M. Hahn}
\affiliation{Space Science Institute}

\author{Douglas P. Hamilton}
\affiliation{University of Maryland}

\author{Thomas Rimlinger}
\affiliation{University of Maryland}

\author{Lucy Luu}
\affiliation{University of Maryland}


%abstract
\begin{abstract}

The following uses a suite of N-body simulations
to illustrate how narrow eccentric planetary ringlets can evolve into a 
self--confining state.

\end{abstract}


%keywords
\keywords{editorials, notices --- miscellaneous --- catalogs --- surveys --- update, me}


\section{Introduction}
\label{sec:intro}

Narrow eccentric planetary ringlets have properties both interesting and
not well understood: sharp edges,
sizable eccentricity gradients, and a confinement mechanism that
inhibits radial spreading due to ring viscosity.
Prevailing ringlet confinement mechanisms include: 
unseen shepherd satellites (reference), periapse pinch (ref), self gravity (ref), and
self-confinement (ref). This study uses N-body simulations to show how narrow
self--gravitating ringlets can evolve into a self-confining state.

\section{Ringlet confinement mechanisms}
\label{sec:confinement}

This section explains the pros and cons of the various ringlet confinement mechanisms,
and then motivates the possibility that ringlets are self confining. That possibility
is explored further via numerical simulations using the epi\_int\_lite N-body integrator.

\section{epi\_int\_lite}
\label{sec:epi_int_lite}

Epi\_int\_lite is a child of the epi\_int N-body integrator that was used to
simulate the outer edge of Saturn's B ring that is sculpted by satellite perturbations
\citep{HS13}. The new code is very similar to its parent but differs in three significant ways:
({\it i}.) epi\_int\_lite is written in python and recoded for more efficient execution,
({\it ii}.) epi\_int\_lite uses a more accurate drift step for 
unperturbed motion around an oblate planet (detailed in Appendix \ref{sec:Appendix A}),
and ({\it iii}.) epi\_int\_lite uses the $C=1$ approximation that is justified below 
(Appendix \ref{sec:Appendix B}).

Otherwise epi\_int\_lite's treatment of ring self--gravity and viscosity are identical
to that used by the parent code; see \cite{HS13} for additional details. The epi\_int\_lite 
source code is available at https://github.com/joehahn/epi\_int\_lite, and the
code's numerical quality is assessed in Appendix \ref{sec:Appendix C}
where the output of several numerical experiments are compared against theoretical predictions.

Calculations performed by epi\_int\_lite use natural units with gravitation constant $G=1$, 
central primary mass $M=1$, and the ringlet's inner edge has initial radius
$r_0=1$, and so the ringlet masses $m_r$ and radii $r$ quoted below are in units of $M$ and $r_0$.
Converting code output from natural units to physical units requires choosing	
physical values for $M$ and $r_0$ and multiplying accordingly, and when this text does so
it assumes Saturn's mass $M=5.68\times10^{29}$ gm and a characteristic
ring radius $r_0=1.0\times10^{10}$ cm.

Initially all particles are assigned to various streamlines across the simulated ringlet. A streamline
is a closed eccentric path around the primary, and the $N_p$ particles in a given
streamline are initially assigned a common semimajor axis $a$ and eccentricity $e$, 
with uniform spacing in longitude. Most of the simulations described below
employ only $N_s=2$ streamlines, so that the model output can be benchmarked against
theoretical treatments that also treat the ringlet as two gravitating rings
(e.g. BGTXX). But the following also performs a few higher-resolution simulations
using $N_s=11$ streamlines, to demonstrate that the $N_s=2$ treatment appears perfectly
adequate and reproduces all the relevant dynamics. All simulations use $N_p=241$ particles 
per streamline, and the total number of particles is $N_sN_p$.
Note that the assignment of particles to a given streamline is merely
for labeling purposes, as particles are still free to wander in response
to the ringâ€™s internal forces, namely, gravity and ring viscosity. But as \cite{HS13} as well
as this work shows, the simulated ring stays coherent and highly organized throughout the 
simulation such that particles on the same streamline do not pass each other longitudinally,
nor do they cross adjacent streamlines. Because the simulated ringlet stays highly organized,
there is no radial or transverse mixing of the ring particles, and simulated particles preserve
their streamline membership over time.


\section{N-body simulations of viscous gravitating ringlets}
\label{sec:nbody}

This Section describes a suite of N-body simulations of narrow viscous gravitating planetary
ringlets, to highlight the range of initial ringlet conditions the do evolve into
a self-confining state, and those that do not.

\subsection{nominal model}
\label{subsec:nominal}

Figure \ref{fig:a_nominal} shows the semimajor axis evolution of what is referred to
as the nominal model since this ringlet readily evolves into a self-confining state.
The simulated ringlet is composed of $N_s=2$ streamlines having $N_p=241$ particles
per streamline, and the integrator timestep is $\Delta t=0.5$ in natural units, so
the integrator samples the particle orbits $2\pi/\Delta t\simeq13$ times per orbit, and this
ringlet is evolved for $6.7\times10^5$ orbits, which requires 40 minutes execution time
on a 5 year old laptop. The ringlet's mass is
$m_r=2\times10^{-9}$, its shear viscosity is $\nu_s=1\times10^{-12}$, and its
bulk viscosity is $\nu_b=1.5\nu_s$. The ringet's initial radial width is
$\Delta a_0 = 5\times10^{-4}$, its initial eccentricity is $e=0.03$, and its
eccentricity gradient is initially zero. A convenient measure of time is the ringlet's
viscous radial spreading timescale,
\begin{equation}
    \tau_\nu=\frac{\Delta a_0^2}{12\nu_s}, 
\end{equation}
which is the time for viscosity to double the radial width of an initially narrow circular ringlet
(Pringle 1981?). This simulation's viscous timescale is $\tau_\nu=2.1\times10^4$ in natural units
or $\tau_\nu/2\pi=3.3\times10^3$ orbital periods. If this ringlet were orbiting Saturn
at $r_0=1.0\times10^{10}$ cm then the simulated ringlet's physical mass
would be $m_r=1.1\times10^{21}$ gm which is equivalent to a $64$ km radius iceball assuming
a volume density $\rho=1$ gm/cm$^3$, and the ringlet's initial radial width would be
$\Delta a_0 = 5\times10^{-4}r_0=50$ km. This ringlet's
orbit period would be $T_{orb}=2\pi\sqrt{r_0^3/GM}=9.0$ hours in physical units, so 
the ringlet's viscous timescale is $\tau_\nu=3.4$ years 
which indicates that $\nu_s=\Delta a_0^2/12\tau_\nu = 1.9\times10^4$ cm$^2$/sec
is the ring viscosity when evaluated in physical units. 
This ringlet's initial surface density would be $\sigma=m_r/2\pi r_0\Delta a_0=3500$ gm/cm$^2$, but
Figs.\ \ref{fig:a_nominal}--\ref{fig:da_nominal} show that shrinks by a factor of 3 as the 
ringlet's sememajor axis width $\Delta a$ grows (due to viscous spreading) until it settles into
the anticipated self-confining state at time $t\sim20\tau_\nu$.
So this so-called nominal
model is probably overdense and overly viscous compared to known planetary rings,
but the suite of simulation described in Sections XX show how various outcomes scale when
other initial masses orbits and viscosities are considered.

\begin{figure}
\plotone{figs/a_nominal.pdf}
\caption{Evolution of the nominal ringlet's semimajor axes $a$ versus time $t$, with time measured
in units of the ringlet's viscous time $\tau_\nu$. This ringlet is composed of $N_s=2$ streamlines,
and the outer (blue) and inner (green) streamlines' semimajor axes are plotted relative
to their mean $a_{\text{mean}}$. 
The simulated ringlet has total mass $m_r=2\times10^{-9}$, shear viscosity $\nu_s=1\times10^{-12}$,
and initial width $\Delta a_0 = 5\times10^{-4}$ in natural units ({\it i.e.}\ $G=M=r_0=1$),
and initial eccentricity $e=0.03$. See Section \ref{subsec:nominal} to convert
these $m_r$, $a$ and $\nu_s$ from natural units to physical units.
\label{fig:a_nominal}}
\end{figure}

\begin{figure}
\plotone{figs/da_nominal.pdf}
\caption{
\label{fig:da_nominal}
The nominal ringlet's semimajor axis width $\Delta a = a_{\text{outer}} - a_{\text{inner}}$ over time, 
in units of its initial radial width $\Delta a_0$.}
\end{figure}

Figure \ref{fig:e_nominal} show that that the outer streamline's eccentricity grows at the
expense of the inner streamline's, and this is a consequence the self-gravitating ringlet's
secular perturbations of itself; this is demonstrated in Fig.\ ?? which re-runs the nominal
simulation with ringlet self-gravity turned off.  Figure \ref{fig:de_nominal} shows
the ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
and longitude of periapse difference
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$,
which both settle into equilibrium values when the ringlet settles into the self-confining
state.

\begin{figure}
\plotone{figs/e_nominal.pdf}
\caption{
\label{fig:e_nominal}
The nominal ringlet's eccentricity evolution.}
\end{figure}

\begin{figure}
\plotone{figs/de_nominal.pdf}
\caption{
\label{fig:de_nominal}
The nominal ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
and longitude of periapse difference
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$.}
\end{figure}

\begin{figure}
\plotone{figs/de_prime_nominal.pdf}
\caption{
\label{fig:de_prime_nominal}
The nominal ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
and longitude of periapse difference
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$.}
\end{figure}

\acknowledgments

acknowledgments...

\appendix

\section{Appendix A}
\label{sec:Appendix A}

Derive the more accurate drift step used by epi\_int\_lite...

\section{Appendix B}
\label{sec:Appendix B}

Detail the $C=1$ approximation used by epi\_int\_lite, and show that the errors
associated with this approximation are negligable...

\section{Appendix C}
\label{sec:Appendix C}

Compare epi\_int\_lite to theoretical predictions

\subsection{radial spreading of viscous viscous}
\label{subsec:spreading}

Show that ringlet viscosity causes circular non-gravitating ringlet to
spread at the expected rate...

%bibliography
%\bibliographystyle{apj}
\bibliography{jmh_bibliography}
\end{document}


\end{document}




\section{Trash}


\subsection{improved drift step around oblate planet}
\label{subsec:drift}


\subsection{kick}
\label{subsec:kick}



Epi\_int is a drift-kick integrator, and such integrators alternate between drifting
(ie advancing) a particle along its unperturbed trajectory, with each drift followed
by a velocity kick that accounts for all other perturbing forces such as ring self gravity
and ring viscosity. Drifting a particle efficiently along its unperturbed trajectory around
an oblate planet requires an analytic
expression for that trajectory, and epi\_int utilized the \cite{BL94} solution
that requires, at every timestep, the conversion of the particle's spatial coordinates
and velocities into geometric orbit elements, with the drifted particle's
orbit elements then converted back to spatial coordinates every timestep. That conversion is accurate
to order ${\cal O}(e^2)$ where $e$ is the particle's geometric eccentricity, but the
conversion from spatial coordinates to orbit elements and back is not reversible, which
means that the drifted particle's trajectory acquires an ${\cal O}(e^3)$ error
every timestep. Although the accumulation of this error was too slow to significantly impact
epi\_int's B ring simulations spanning $10^4$ orbit periods, this error does preclude 
using that code to simulate the much slower viscous evolution of ringlets over $10^6$ orbit periods.

To avoid this accumulation of drift errors, Section \ref{sec:drift-kick} derives an alternate set of geometric
orbit elements that describe the particle's unperturbed motion around an oblate planet. Note though
the conversion of spatial coordinates to the new geometric orbit elements is exact
and reversible, and so epi\_int\_lite's drift step is not a significant source of error. 

The chief principal guiding the developement of epi\_int\_lite is that the code be
accurate to solve the problem at hand while also being as simple
as possible so that the code can be developed, tested, and executed as swiftly as possble.
With this in mind, several simplifying approximations are made and are detailed
below in Section \ref{subsec:approximations} and they simplify code development and
shorten run times significantly. Section \ref{sec:testing} then assesses the impact
of those approximations, and shows that they are truly negligable and do not affect outcomes
or conclusions.




Although the epi\_int integrator was well-suited for evolving the
B ring edge over the $\sim3\times10^4$ orbits needed to monitor the B ring's response to Mimas
perturbations, that code lacked sufficient numerical accuracy to evolve a ringlet
during the $\sim3\times10^6$? orbits needed to track its slow radial spreading due to ringlet viscosity.
That inability was traced to epi\_int's drift step, and Section ? describes
how that is mitigated in the new code.
