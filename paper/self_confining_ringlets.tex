%self_confining_ringlets.tex
%
%by Joe Hahn et al, jhahn@spacescience.org, 20 November 2018.
%
%draft ApJ paper on epi_int_lite simulations of self confining ringlets.
%
%to compile:
%    pdflatex self_confining_ringlets
%    bibtex self_confining_ringlets
%    pdflatex self_confining_ringlets


\documentclass[preprint]{aastex62}

%bibliography, see
%http://ads.harvard.edu/pubs/bibtex/astronat/doc/html/astronat_3.html
\usepackage{natbib}
\usepackage{amsmath}
%\citestyle{aa}

%journal
\received{not yet}
\revised{not yet}
\accepted{not yet}
\submitjournal{Somewhere, eventually}

%short names
\shorttitle{Narrow Eccentric Ringlets}
\shortauthors{Hahn et al.}


\begin{document}


%title page
\title{N-body simulations of the Self--Confinement of 
Viscous Self--Gravitating Narrow Eccentric Planetary Ringlets}

\correspondingauthor{Joseph M. Hahn}
\email{jhahn@spacescience.org}

\author{Joseph M. Hahn}
\affiliation{Space Science Institute}

\author{Douglas P. Hamilton}
\affiliation{University of Maryland}

\author{Thomas Rimlinger}
\affiliation{University of Maryland}

\author{Lucy Luu}
\affiliation{University of Maryland}


%abstract
\begin{abstract}

N-body simulations are used
to illustrate how narrow eccentric planetary ringlets can evolve into a 
self--confining state.

\end{abstract}


%keywords
\keywords{editorials, notices --- miscellaneous --- catalogs --- surveys --- update, me}


\section{Introduction}
\label{sec:intro}

Narrow eccentric planetary ringlets have properties both interesting and
not well understood: sharp edges,
sizable eccentricity gradients, and a confinement mechanism that
opposes radial spreading due to ring viscosity. To date, nearly all of the
prevailing ringlet confinement mechanisms assume that there also exists a pair of 
unseen shepherd satellites that straddle the ringlet, with those shepherd gravities
also torquing the ringlet in a way that keeps it radially confined 
(\citealt{GT79, GT79c, GT81, CG00, ME02}). However the Cassini spacecraft failed to detect
any such shepherds near Saturn's narrow ringlets, which casts doubt upon that confinement mechanism
\citep{L18}. Note though that \cite{BGT82} showed that a viscous ringlet that has
a sufficiently high eccentricity gradient can in fact be self-confining,
due to the resulting reversal of the viscous angular momentum flux. 
Which motivates this study, which uses the epi\_int\_lite N-body integrator to 
investigate whether a viscous and self--gravitating ringlet might evolve into a self-confining state.

\section{epi\_int\_lite}
\label{sec:epi_int_lite}

Epi\_int\_lite is a child of the epi\_int N-body integrator that was used to
simulate the outer edge of Saturn's B ring while it is sculpted by satellite perturbations
\citep{HS13}. The new code is very similar to its parent but differs in two significant ways:
({\it i}.) epi\_int\_lite is written in python and recoded for more efficient execution, and
({\it ii}.) epi\_int\_lite uses a more reliable drift step to handle
unperturbed motion around an oblate planet (detailed in Appendix \ref{sec:Appendix A}).

Otherwise epi\_int\_lite's treatment of ring self--gravity and viscosity are identical
to that used by the parent code; see \cite{HS13} for additional details. The epi\_int\_lite 
source code is available at https://github.com/joehahn/epi\_int\_lite, and the
code's numerical quality is assessed in Appendix \ref{sec:Appendix B}
where the output of several numerical experiments are compared against theoretical expectations.

Calculations by epi\_int\_lite use natural units with gravitation constant $G=1$, 
central primary mass $M=1$, and the ringlet's inner edge has initial radius
$r_0=1$, and so the ringlet masses $m_r$ and radii $r$ quoted below are in units of $M$ and $r_0$.
Converting code output from natural units to physical units requires choosing	
physical values for $M$ and $r_0$ and multiplying accordingly, and when this text does so
it assumes Saturn's mass $M=5.68\times10^{29}$ gm and a characteristic
ring radius $r_0=1.0\times10^{10}$ cm. Simulation time $t$ is in units of $T_{\text{orb}}/2\pi$
where $T_{\text{orb}} = 2\pi\sqrt{r_0^3/GM}$ is the orbit period at $r_0$, 
so divide simulation time $t$ by $2\pi$ and multiply
by $T_{\text{orb}}$ to convert simulation time from natural to physical units.
The simulated particles' motions during the drift step are also
sensitive to the $J_2$ portion of the primary's non-spherical gravity component 
(see Appendix \ref{sec:Appendix B}), and all simulations
adopt Saturn-like values of $J_2=0.01$ and $R_p=r_0/2$ where $R_p$ is the planet's
mean radius.

\subsection{streamlines}
\label{subsec:streamlines}

Initially all particles are assigned to various streamlines across the simulated ringlet. A streamline
is a closed eccentric path around the primary, and each streamline is populated by $N_p$ particles that are
initially assigned a common semimajor axis $a$ and eccentricity $e$ while
distributed uniformly in longitude. Most of the simulations described below
employ only $N_s=2$ streamlines, so that the model output can be benchmarked against
theoretical treatments that also treat the ringlet as two gravitating rings
(e.g.\ \citealt{BGT83}). But the following also performs a few higher-resolution simulations
using $N_s=11$ streamlines, to demonstrate that the $N_s=2$ treatment is perfectly
adequate and reproduces all the relevant dynamics. All simulations use $N_p=241$ particles 
per streamline, and the total number of particles is $N_sN_p$.
Note that the assignment of particles to a given streamline is merely
for labeling purposes, as particles are still free to wander in response
to the ringâ€™s internal forces, namely, ring gravity and viscosity. But as \cite{HS13} as well
as this work shows, the simulated ring stays coherent and highly organized throughout the 
simulation such that particles on the same streamline do not pass each other longitudinally,
nor do they cross adjacent streamlines. Because the simulated ringlet stays highly organized,
there is no radial or longitudinal mixing of the ring particles, and simulated particles preserve
their streamline membership over time. 

The epi\_int\_lite code also monitors all particles and checks whether any have crossed adjacent streamlines.
If that happens the simulation is then terminated since the particles' subsequent evolution
would no longer be computed reliably.

\subsection{N-body method}
\label{subsec:N-body method}

The epi\_int\_lite N-body integrator uses the same drift-kick
scheme used by the MERCURY Nbody algorithm \citep{C99} except that
epi\_int\_lite particles that do not interact with each other directly.
Rather, epi\_int\_lite particles
are only perturbed by the accelerations exerted by the ringlet's individual streamlines. 
Those accelerations are sensitive to the streamline's relative separations and velocities, 
which are inferred from the particles' positions
and velocities. Epi\_int\_lite particles are thus trace particles
that indicate the streamlines' locations and orientations, which the N-body
integrator uses to compute the orbital evolution of those trace particles
due to the perturbations exerted by those streamlines. This streamline approach 
is widely used in theoretical studies of planetary rings (c.f.\ \citealt{GT79, BGT83, BGT85})
as well as in N-body studies of rings \citep{HS13, RHH16}. The great benefit of the streamline concept
in numerical work is that it allows one to swiftly track the 
global evolution of the ringlet's streamlines numerically
using only a modest numbers of trace particles, typically $N_sN_p\sim500$.

The simulations reported on here account for streamline gravity
and ringlet viscosity. Because a ringlet is narrow, all particles
are in close proximity to the nearby portions of all streamlines,
which allows us to approximate a streamline as an infinitely
long wire of matter having linear density $\lambda$.
Consequently the gravity of each perturbing streamline draws a particle
towards that streamline with acceleration
\begin{equation}
\label{eqn:gravity}
    A_g=\frac{2G\lambda}{\Delta },
\end{equation}
where $\Delta$ is the particle's distance from the streamline.

The hydrodynamic approximation is used here to account for
the dissipation that occurs as particles in adjacent particle streamlines
shear past and collide with the perturbed particle,
without having to monitor individual particle-particle collisions.
The particle's acceleration due to the ring particles' shear viscosity is
\begin{equation}
\label{eqn:shear_viscosity}
    A_{\nu,\parallel}=-\frac{1}{\sigma r}\frac{\partial {\cal F}_L}{\partial r},
\end{equation}
where $r$ is the particle's radial coordinate, 
$\sigma$ is the surface density of ringlet matter, and 
${\cal F}_{L,\nu}$ is the flux of angular momentum
that is transported radially across the particle's streamline
due to its collisions with particles in adjacent streamlines, {\it i.e.}\
\begin{equation}
    \label{eqn:F_nu_theta}
    {\cal F}_{L,\nu} = -\nu_s \sigma r^2\frac{\partial\omega}{\partial r}
\end{equation}
where $\nu_s$ is the ringlet's kinematic shear viscosity
and $\omega=v_\theta/r$ is the particle's angular velocity \citep{HS13}.
The acceleration $A_{\nu,\parallel }$ is parallel to the perturbed particle's streamline
{\it i.e.}\ parallel to particle's velocity vector
$\mathbf{v}=\dot{\mathbf{r}}=v_r\hat{r} + v_\theta\hat{\theta}$ 
where $\mathbf{r} = r\hat{\mathbf{r}}$ is the particle's position vector.

Dissipative collisions also transmits linear momentum in the perpendicular direction,
which results in the additional acceleration
\begin{equation}
\label{eqn:bulk_viscosity}
    A_{\nu, \perp}=-\frac{1}{\sigma}\frac{\partial {\cal G}}{\partial r} 
\end{equation}
where the radial flux of linear momentum due to ringlet viscosity is
\begin{equation}
    \label{eqn:G}
    {\cal G} = -\left(\frac{4}{3}\nu_s + \nu_b\right)\sigma\frac{\partial v_r}{\partial r}
        -\left(\nu_b - \frac{2}{3}\nu_s\right)\frac{\sigma v_r}{r}
\end{equation}
$\nu_b$ is the ringlet's kinematic bulk viscosity and $v_r$ is the paricle's radial velocity
\citep{HS13}.

In the hydrodynamic approximation there is also the acceleration due to ringlet pressure $p$
that is due to particle-particle collisions,
\begin{equation}
\label{eqn:pressure}
    A_p=-\frac{1}{\sigma }\frac{\partial p}{\partial r}.
\end{equation}
Epi\_int\_lite treats the particle ring as a dilute gas of
colliding particles for which the 1D pressure is $p=c^2\sigma$ where
c is the particles dispersion velocity. However \cite{HS13} found ring pressure
to be inconsequential in N-body simulations of Saturn's A ring, and the ringlet simulation
examined in great detail in Section \ref{subsec:nominal} 
also showed no sensitivity to pressure effects, so all other
simulations reported on here have $c=0$.

\section{N-body simulations of viscous gravitating ringlets}
\label{sec:nbody}

The folowing describes a suite of N-body simulations of narrow viscous gravitating planetary
ringlets, to highlight the range of initial ringlet conditions the do evolve into
a self-confining state, and those that do not.

\subsection{nominal model}
\label{subsec:nominal}

Figure \ref{fig:a_nominal} shows the semimajor axis evolution of what is referred to
as the nominal model since this ringlet readily evolves into a self-confining state.
The simulated ringlet is composed of $N_s=2$ streamlines having $N_p=241$ particles
per streamline, and the integrator timestep is $\Delta t=0.5$ in natural units, so
the integrator samples the particles' orbits $2\pi/\Delta t\simeq13$ times per orbit, and this
ringlet is evolved for $4.7\times10^3$ orbits, which requires 15 minutes execution time
on a 5 year old laptop. The ringlet's mass is
$m_r=5\times10^{-10}$, its shear viscosity is $\nu_s=2.5\times10^{-12}$, and its
bulk viscosity is $\nu_b=\nu_s$. The ringet's initial radial width is
$\Delta a_0 = 3\times10^{-4}$, its initial eccentricity is $e=0.01$, and its
eccentricity gradient is initially zero. A convenient measure of time is the ringlet's
viscous radial spreading timescale
\begin{equation}
\label{eqn:viscous-timesscale}
    \tau_\nu=\frac{\Delta a_0^2}{12\nu_s}, 
\end{equation}
which can be inferred from Eqn.\ (2.13) of \cite{P81}. 
This simulation's viscous timescale is $\tau_\nu=3.0\times10^3$ in natural units
or $\tau_\nu/2\pi=4.8\times10^2$ orbital periods. If this ringlet were orbiting Saturn
at $r_0=1.0\times10^{10}$ cm then the simulated ringlet's physical mass
would be $m_r=2.8\times10^{20}$ gm which is equivalent to the mass of a $41$ km radius iceball assuming
a volume density $\rho=1$ gm/cm$^3$, and the ringlet's initial radial width would be
$\Delta a_0 = 3\times10^{-4}r_0=30$ km. This ringlet's
orbit period would be $T_{orb}=2\pi\sqrt{r_0^3/GM}=9.0$ hours in physical units, so 
the ringlet's viscous timescale is $\tau_\nu=12$ years, and
so its shear viscosity is $\nu_s=\Delta a_0^2/12\tau_\nu = 4.8\times10^4$ cm$^2$/sec
when evaluated in physical units. 
This ringlet's initial surface density would be $\sigma=m_r/2\pi r_0\Delta a_0=1500$ gm/cm$^2$, but
Figs.\ \ref{fig:a_nominal}--\ref{fig:da_nominal} show that shrinks by a factor of 4 as the 
ringlet's sememajor axis width $\Delta a$ grows via viscous spreading until it settles into
the self-confining state at time $t\sim20\tau_\nu$.
This so-called nominal ringlet is probably overdense and overly viscous compared to known 
planetary ringlets,
but that is by design so that the simulated ringlet quickly settles into the self-confining state.
Section XX also shows how outcomes scale when a wide variety of alternate initial masses, orbits,
and viscosities are also considered.

\begin{figure}
\plotone{figs/a_nominal.pdf}
\caption{Evolution of the nominal ringlet's semimajor axes $a$
versus time $t$ in units of the ringlet's viscous time $\tau_\nu$.
This ringlet is composed of $N_s=2$ streamlines,
and the outer (blue) and inner (green) streamlines' semimajor axes are plotted relative
to their mean $a_{\text{mean}}$, and displayed in units of the ringlet's
initial width $\Delta a_0 = 3\times10^{-4}$ in natural units ({\it i.e.}\ $G=M=r_0=1$).
The simulated ringlet has total mass $m_r=5\times10^{-10}$, shear viscosity $\nu_s=2.5\times10^{-12}$,
and initial eccentricity $e=0.01$. See Section \ref{subsec:nominal} to convert
$m_r$, $a$ and $\nu_s$ from natural units to physical units.
\label{fig:a_nominal}}
\end{figure}

\begin{figure}
\plotone{figs/da_nominal.pdf}
\caption{
\label{fig:da_nominal}
The nominal ringlet's semimajor axis width $\Delta a = a_{\text{outer}} - a_{\text{inner}}$ over time
and in units of its initial radial width $\Delta a_0$.}
\end{figure}

Figure \ref{fig:e_nominal} shows that the outer streamline's eccentricity initially grows at the
expense of the inner streamline's, and this is a consequence the self-gravitating ringlet's
secular perturbations of itself, which is also demonstrated in Appendix \ref{sec:Appendix D}. 
Figure \ref{fig:de_nominal} shows
the ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
and longitude of periapse difference
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$,
which both settle into equilibrium values after the ringlet arrives at the self-confining
state.

\begin{figure}
\plotone{figs/e_nominal.pdf}
\caption{
\label{fig:e_nominal}
The nominal ringlet's eccentricity evolution.}
\end{figure}

\begin{figure}
    \plotone{figs/de_dwt_nominal.pdf}
    \caption{
        \label{fig:de_nominal}
        The nominal ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$
        and longitude of periapse difference
        $\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$
        in radians divided by 10.
    }
\end{figure}

Figure \ref{fig:nominal_streamlines} shows the radii of the ringlet's two streamlines plotted
versus their relative longitude $\varphi=\theta-\tilde{\omega}_{\text{inner}}$ at time $t=100\tau_\nu$
when the simulation ends. In all simulations examined here, the ringlet's periapse twist 
$\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}}$ is negative,
so the outer streamline's longitude of periapse $\tilde{\omega}$ trails
the inner streamline's, which in turn causes the streamlines' separations along
the ringlet's pre-periapse side (where $\varphi < 0$) to be smaller than at post-periapse ($\varphi>0$).
Which makes the ringlet's surface density asymmetric, with maximum surface density
occurring just prior to periapse, see Figs.\ \ref{fig:nominal_streamlines}--\ref{fig:radial_sigma_nominal}.

\begin{figure}
    \plotone{figs/nominal_streamlines.pdf}
    \caption{
        \label{fig:nominal_streamlines}
        The radii of the nominal ringlet's streamlines are plotted versus relative longitude
        $\varphi=\theta-\tilde{\omega}$ at time $t=100\tau_\nu$, with $\Delta a$ being the streamlines'
        semimajor axis difference then. Inset plot
        shows outer streamline's longitude of periapse $\tilde{\omega}$ trailing
        the inner streamline's.
    }
\end{figure}

\begin{figure}
    \plotone{figs/nominal_sigma_vs_longitude.pdf}
    \caption{
        \label{fig:nominal_sigma_vs_longitude}
        Nominal ringlet's surface density $\sigma(\varphi)$ versus relative
        longitude $\varphi$ at selected times $t$ and plotted in units of ringlet's initial
        mean surface density $\sigma_0$. Note that the ringlet's surface
        density maxima occurs just before peripase,  and is due to the ringlet's
        negative periapse twist 
        $\Delta\tilde{\omega} = \tilde{\omega}_{\text{outer}} - \tilde{\omega}_{\text{inner}} < 0$.
    }
\end{figure}

\begin{figure}
    \plotone{figs/radial_sigma_nominal.pdf}
    \caption{
        \label{fig:radial_sigma_nominal}
        Radial profiles of the nominal ringlet's surface density $\sigma(\varphi)$ at time $t/\tau_\nu=100$
        when the ringlet is self-confining. Each surface density profile is plotted versus radial distance $r$ 
        relative to $r_{mid}$, which is the ringlet's midpoint along relative longitude $\varphi = \theta-\tilde{\omega}$,
        with those radial distances $r - r_{mid}$ measured in units of the ringlet's final semimajor axis width $\Delta a$,
        and surface density is shown in units of the ringlet's longitudinally-averaged surface density $\sigma_0$.
        Radial surface density profiles are plotted along the ringlet's periapse ($\varphi=0$, blue curve), which is 
        where the ringlet's streamlines are most concentrated and surface denisity $\sigma$ is
        greatest due to the ringlet's eccentricity gradient $e'$, at the pre-periapse
        quadrature ($\varphi=-\pi/2$, red curve), post-periapse
        quadrature ($\varphi=\pi/2$, green curve)
        and at apoapse ($|\varphi|=\pi$, orange curve) where streamlines have their greatest separation
        and ringlet surface density is lowest. This ringlet's surface density contrast, between periapse and
        apoapse, is 14.
    }
\end{figure}

It is convenient to recast these orbit element differences as dimensionless gradients
\begin{equation}
    \label{eqn:e_prime}
    e' = a\frac{de}{da}
    \qquad\mbox{and}\qquad
    \tilde{\omega}' = ea\frac{d\tilde{\omega}}{da}
\end{equation}
as these are the terms that contribute to the nonlinearity parameter of \cite{BGT83}:
\begin{equation}
    \label{eqn:q}
    q = \sqrt{e'^2 + \tilde{\omega}'^2}.
\end{equation}
See also Fig.\ \ref{fig:de_prime_nominal} which plot's the nominal
ringlet's dimensionless eccentricity gradient $e'$, dimensionless periapse twist $\tilde{\omega}'$,
and nonlinearity parameter $q$ versus time. All simulations examined here have
$|\tilde{\omega}'|\ll|e'|$ so that $q\simeq|e'|$, and all simulated self-confining ringlets
have a positive eccenticity gradient and a negative periapse twist such that
the outer ringlet's periapse trails the inner ringlet's, consistent with the findings of
\cite{BGT83}.\vfil

\begin{figure}
    \plotone{figs/de_prime_nominal.pdf}
    \caption{
        \label{fig:de_prime_nominal}
        The nominal ringlet's dimensionless eccentricity gradient $e' = a\Delta e/\Delta a$
        (blue curve), dimensionless periapse twist $\tilde{\omega}' = ea\Delta\tilde{\omega}/\Delta a$
        (orange), and nonlinearity parameter $q=\sqrt{e'^2 + \tilde{\omega}'^2}$
        (green) versus time $t/\tau_\nu$. Dotted red line 
        is the threshold for self-confinement in a non-gravitating ringlet, $e'=\sqrt{3}/2\simeq0.866$
    }
\end{figure}\vfil


\section{angular momentum and energy fluxes, and luminosities}
\label{sec:fluxes}

The above evolution is readily understood when the ringlet's 
radial flux of angular momentum and energy are considered. 

\subsection{angular momentum and energy fluxes}
\label{subsec:fluxes}

The torque that is exerted on a small streamline segment of mass $\delta m$
at location $\mathbf{r}=r\hat{\mathbf{r}}$
due to the streamlines orbiting interior to it is $\delta T=\delta m\mathbf{r}\times\mathbf{A}^1$ where 
$\mathbf{A}^1=A^1_r\hat{\mathbf{r}} + A^1_\theta\hat{\boldsymbol\theta}$
is the so-called one-sided acceleration that is exerted on $\delta m$ by the interior streamlines. 
Since $\delta m=\lambda\delta\ell$ where $\lambda$ is the streamline's linear mass density,
and $\delta\ell$ is the segment's length, then the radial flux of angular momentum flowing into
that segment due to the accelerations that are exerted by streamlines orbiting interior to that
segment is
\begin{equation}
    \label{eqn:F_L}
    {\cal F}_L(r, \theta) = \frac{\delta T}{\delta\ell} = \lambda r A^1_\theta,
\end{equation}
where $A^1_\theta$ is the tangential component of the one-sided acceleration.
A streamline of semimajor axis $a$ in a ringlet having total mass $m_r$ 
distributed across $N_s$ streamlines will have a linear mass density $\lambda=m_r/N_s/2\pi a$.
The radial angular momentum flux, Eqn.\ (\ref{eqn:F_L}), is due to the ringlet's viscosity and self-gravity,
so ${\cal F}_L = {\cal F}_{L,\nu} + {\cal F}_{L,g}$. 

The work that the interior streamlines exert on $\delta m$ as that segment travels a small distance
$\delta\mathbf{r}=\mathbf{v}\delta t$ in time $\delta t$
is $\delta W=\delta m\mathbf{A}^1\cdot\delta\mathbf{r}$ where 
$\mathbf{v}=v_r\hat{\mathbf{r}} + v_\theta\hat{\boldsymbol\theta}$ is the segment's velocity, and
that work accrues at $\delta m$ at the rate 
$\delta W/\delta t=\lambda\mathbf{A}^1\cdot\mathbf{v}\delta\ell$,
so the radial flux of energy entering that ringlet segment due to accelerations
exerted by the interior streamlines is 
\begin{equation}
    \label{eqn:F_E}
    {\cal F}_E(r, \theta) = \frac{\delta W}{\delta\ell\delta t} = \lambda\mathbf{A}^1\cdot\mathbf{v},
\end{equation}
and this radial energy flux is due to the ringlet's viscosity and self-gravity,
${\cal F}_E = {\cal F}_{E,\nu} + {\cal F}_{E,g}$. 

\subsection{luminosities}
\label{subsec:luminosities}

The streamline containing segment $\delta m$ has semimajor axis $a$, and 
integrating the radial angular momentum flux ${\cal F}_L$ about the entire streamline
then yields the radial luminosity of angular momentum entering streamline $a$,
\begin{equation}
    \label{eqn:L_L}
    {\cal L}_L(a) = \oint {\cal F}_Ld\ell , 
\end{equation}
which is the torque that is exerted on streamline $a$ by those orbiting interior to it. Similarly,
integrating the radial energy flux ${\cal F}_E$ about streamline $a$ also yields the ringlet's radial energy luminosity
\begin{equation}
    \label{eqn:L_E}
    {\cal L}_E(a) = \oint {\cal F}_Ed\ell,
\end{equation}
and this is the rate that interior streamlines communicate energy to streamline $a$.

\subsection{viscous transport of angular momentum}
\label{subsec:viscous_flux}

Angular momentum is transported radially through the ring via viscosity and self-gravity, 
so ${\cal F}_L={\cal F}_{L,\nu} + {\cal F}_{L,g}$,
where the ringlet's viscous flux of angular momentum is Eqn.\ \ref{eqn:F_nu_theta},
\begin{equation}
    {\cal F}_{L,\nu}(r, \theta) = -\nu_s \sigma r^2\frac{\partial\omega}{\partial r}
\end{equation}
when written as a function of spatial coordinates and
angular velocity $\omega=\dot{\theta}$ (Eqn.\ \ref{eqn:F_nu_theta}). 
If we consider a small arc of 
ring material oflength $d\ell$, 
then ${\cal F}_{L,\nu}d\ell$ is the torque that arc exert exerts on
ring matter just exterior, due to viscous friction,
so that is the rate that friction transmits angular momentum radially across that arc.
And when ${\cal F}_{L,\nu}$ is evaluated along a single eccentric streamline of semimajor axis $a$, 
the above simplifies to
\begin{equation}
    \label{eqn:F_nu_varphi}
    {\cal F}_{L,\nu}(a, \varphi) = {\cal F}_{L,\nu,c}\frac{1-\frac{4}{3}e'\cos\varphi}{(1-e'\cos\varphi)^2}
\end{equation}
where $\varphi=\theta-\tilde{\omega}$ is the longitude relative to periapse
and ${\cal F}_{L,\nu,c}=\frac{3}{2}\nu_s\sigma_0a\Omega$ is the viscous angular momentum flux through a
circular streamline of semimajor axis $a$ and angular speed $\Omega(a)$,
with Eqn.\ (\ref{eqn:F_nu_varphi}) assuming  that
$|\tilde{\omega}'|\ll e'$ so that $q\simeq e'$
(see \citealt{BGT82} and Appendix \ref{sec:Appendix E}). Integrating the above
around the streamline's circumference then yields its angular momentumum luminosity,
\begin{equation}
    \label{eqn:L_nu}
    {\cal L}_{L,\nu}(a) = \oint {\cal F}_{L,\nu}(a, \varphi)rd\varphi = {\cal L}_{L,\nu,c}\frac{1-\frac{4}{3}e'^2}{(1-e'^2)^{3/2}},
\end{equation}
which is the torque that one streamline exerts on its exterior neighbor due to viscous friction
(\citealt{BGT82} and Appendix \ref{sec:Appendix E}),
with ${\cal L}_{L,\nu,c}=3\pi\nu_s\sigma_0a^2\Omega$
being the viscous angular momentum luminosity of a circular streamline.

\citet{BGT82} examine angular momentum transport through a viscous eccentric but non-gravitating ringlet, 
and use Eqns.\ (\ref{eqn:F_nu_varphi}--\ref{eqn:L_nu}) to show that this transport has three 
regimes distinguished by the ringlet's $e'$:

\begin{enumerate}

\item $e'<3/4$. The ringlet's viscous angular momentum flux ${\cal F}_{L,\nu}(\varphi)>0$
at all ringlet longitudes $\theta$. The ringlet's viscous
angular momentum luminosity ${\cal L}_{L,\nu}>0$, so viscous friction transports angular momentum radially outwards,
and the inner ring matter evolves to smaller orbits while exterior ring matter evolves outwards, and
the ringlet spreads radially.

\item $3/4\le e'<\sqrt{3}/2$. In this regime there is a range of longitudes $\theta$
where the viscous angular momentum flux is reversed such that ${\cal F}_{L,\nu}(\varphi)<0$. 
That angular momentum flux reversal is due to the $\partial\omega/\partial r$
term in Eqn.\ (\ref{eqn:F_nu_theta}) changing sign near periapse when $e'>0.75$; 
see Fig.\ \ref{fig:nominal_shear}.
Nonetheless ${\cal L}_{L,\nu}$, which is proportional to the orbit-average of ${\cal F}_{L,\nu}(\varphi)$,
is positive and the ringlet still spreads radially, albeit slower than when $e'<0.75$.

\item $e'>\sqrt{3}/2$. Viscous angular momentum flux reversal is complete such that ${\cal L}_{L,\nu}<0$,
viscous friction transports angular momentum radially inwards, and the ringlet
shrinks radially. But if $e'=\sqrt{3}/2\simeq0.866$ then ${\cal L}_{L,\nu}=0$ and the ringlet's
radial evolution ceases, and the viscous but non-gravitating ringlet is self confining.

\end{enumerate}
 
Note though that the nominal ringlet's eccentricity gradient
exceeds the $e'=\sqrt{3}/4\simeq0.866$ threshold (which is
the dotted red line in Fig.\ \ref{fig:de_prime_nominal}) when it settles into
self-confinement. This is due to the ringlet's self-gravity,
which also transports a flux of angular momentum ${\cal F}_{L,g}$ radially through the ringlet.

Figure \ref{fig:F_nu_nominal} shows the nominal ringlet's viscous angular momentum flux
${\cal F}_{L,\nu}$ versus relative longitude $\varphi=\theta-\tilde{\omega}$ at selected times $t$.
Early in the ringlet's evolution when time $t \le 8\tau_\nu$ (blue, orange, green, red,
and purple curves),
the ringlet is in regime 1 since $e'<0.75$ and ${\cal F}_{L,\nu}(\varphi)>0$ at all longitudes.
But by time $t = 10\tau_\nu$ (brown curve), this ringlet's eccentricity gradient exceeds $0.75$,
and angular momentum flux reversal ${\cal F}_{L,\nu}(\varphi)<0$ occurs near periapse where $|\varphi|\simeq0$
where the ringlet is most overdense due to its eccentricity gradient, see 
also Fig.\ \ref{fig:radial_sigma_nominal};
this ringlet is in regime 2 and its radial spreading is reduced by angular momentum flux reversal. 
And by time $t = 20\tau_\nu$ (yellow curve), this ringlet is seemingly in regime 3
since $e'=0.866$, so one might expect the ringlet's spreading to have stalled by
now, but keep in mind that the above analysis ignores any transport
of angular momentum via ringlet self--gravity. Figure \ref{fig:da_nominal}
shows that this gravitating ringlet's spreading has ceased soon after time $t \simeq35\tau_\nu$, 
at which point $e'=0.88$ (cyan curve), angular momentum flux reversal is nearly complete,
with the ringlet's total angular momentum luminosity ${\cal L}_L={\cal L}_{L,\nu}+{\cal L}_{L,g}$ is very close to zero.

Figure \ref{fig:angular_momentum_luminosity_nominal} and
Fig.\ \ref{fig:angular_momentum_luminosity_zoom_nominal} show that, when the ringlet is self-confining
at times $t\gg35\tau_\nu$, its positive viscous angular momentum luminosity ${\cal L}_{L,\nu}\simeq0.0085{\cal L}_{L,\nu,c}$ 
is nearly but not quitely counterbalanced
by its negative gravitational angular momentum luminosity ${\cal L}_{L,g}\simeq-0.0075{\cal L}_{L,\nu,c}$. 
That ${\cal L}_{L,\nu}$ and ${\cal L}_{L,g}$
are both offset slightly from zero also tells us that ringlet self-gravity causes
the streamline's shape and/or orientations differ 
slightly from the non-gravitating solution of \citet{BGT82}. Interestingly, 
Fig.\ \ref{fig:angular_momentum_luminosity_zoom_nominal} also shows that ${\cal L}_{L,\nu}+{\cal L}_{L,g}$ does not sum
precisely to zero, {\it i.e.}\ 
${\cal L}_{L}={\cal L}_{L,\nu}+{\cal L}_{L,g}\simeq0.001{\cal L}_{L,\nu,c}$, 
yet Section \ref{subsec:gravitational_flux}
will show that this ringlet's energy luminosity ${\cal L}_E$ is zero. Evidently it is 
${\cal L}_E$ that must be zero (rather than ${\cal L}_L$) in order for a viscous gravitating ringlet
to be self-confining, since ${\cal L}_E=0$ is required for the
streamlines' semimajor axes $a$ to not evolve relative to each other.
That this ringlet's ${\cal L}_L$ is slightly nonzero while ${\cal L}_E=0$ also implies that this ringlet's
eccentricities are still slowly evolving despite the 
self-confinement, which is evident in inset Fig.\ \ref{fig:de_nominal_zoom}.

\begin{figure}
    \plotone{figs/nominal_shear.pdf}
    \caption{
        \label{fig:nominal_shear}
        The nominal ringlet's angular shear $\partial\omega/\partial r$ is plotted versus relative 
        longitude $\varphi$ at selected moments in time; this quantity is negative when the inner streamline
        has the higher angular speed $\omega=v_\theta/r$. When the simulation starts, this nearly circular
        ringlet has eccentricity gradient $e'=0$, so $\partial\omega/\partial r\simeq-3\Omega/2r\simeq-1.5$ 
        when evaluated natural units (blue curve).
        The ringlet's $e'$ then grows over time (orange, green, red curves),
        which reverses the sign of $\partial\omega/\partial r$
        near periapse when $e'>0.75$; here the inner ringlet's angular speed
        is slower than the outer ringlet, and viscous friction causes angular momentum to instead flow inwards
        at these longitudes. 
    }
\end{figure}

\begin{figure}
    \plotone{figs/F_nu_nominal.pdf}
    \caption{
        \label{fig:F_nu_nominal}
        The nominal ringlet's viscous angular momentum flux ${\cal F}_{L,\nu}(\varphi)$,
        Eqn.\ (\ref{eqn:F_nu_varphi}), is plotted versus ringlet
        relative longitude $\varphi=\theta-\tilde{\omega}$ about the ringlet's inner
        streamline at selected times $t/\tau_\nu$, 
        with the ringlet's eccentricy gradient $e'$ also indicated, 
        and ${\cal F}_{L,\nu,c}$ the angular momentum flux in a circular ringlet
    }
\end{figure}

\begin{figure}
    \plotone{figs/angular_momentum_luminosity_nominal.pdf}
    \caption{
        \label{fig:angular_momentum_luminosity_nominal}
        Nominal ringlet's viscous angular momentum luminosity ${\cal L}_{L,\nu}$ (blue curve) versus time $t/\tau_\nu$
        and in units of a circular ring's viscous angular momentum luminosity ${\cal L}_{L,\nu,c}$, 
        as well as the ringlet gravitational angular momentum luminosity ${\cal L}_{L,g}$ (orange curve).
    }
\end{figure}

\begin{figure}
    \plotone{figs/angular_momentum_luminosity_zoom_nominal.pdf}
    \caption{
        \label{fig:angular_momentum_luminosity_zoom_nominal}
        Figure \ref{fig:angular_momentum_luminosity_nominal} is replotted to highlight that the ringlet's 
        viscous angular momentum luminosity ${\cal L}_{L,\nu}$ (blue curve)
        always stays positive (indicating that the viscous transport of angular momentum is radially outwards) which is 
        nearly but not entirely balanced by the ringlet's negative ({\it i.e.}\ inwards) gravitational angular momentum luminosity 
        ${\cal L}_{L,g}$ (orange) after time $t\gg35\tau_\nu$. Green curve is total angular momentum luminosity 
        ${\cal L}_{L,\nu} + {\cal L}_{L,g}\simeq0.001{\cal L}_{L,\nu,c}$.
    }
\end{figure}

\begin{figure}
    \plotone{figs/de_nominal_zoom.pdf}
    \caption{
        \label{fig:de_nominal_zoom}
        The nominal ringlet's eccentricity difference $\Delta e = e_{\text{outer}} - e_{\text{inner}}$ 
        from Fig. \ref{fig:de_nominal}, 
        with inset plot showing that $\Delta e$ continues to slowly grow even after self-confinement
        is established. 
    }
\end{figure}

\begin{figure}
    \plotone{figs/F_vs_longitude_nominal.pdf}
    \caption{
        \label{fig:F_vs_longitude_nominal}
        The nominal ringlet's viscous angular momentum flux ${\cal F}_{L,\nu}(\varphi)$ (blue curve) is computed
        via Eqn.\ (\ref{eqn:F_nu_theta}) and plotted in units of a circular ringlet's flux ${\cal F}_{L,\nu,c}$
        and versus relative longitude $\varphi$ as the simulation's end at time $t=100\tau_\nu$, 
        as well as the ringlet's gravitational angular momentum flux ${\cal F}_{L,g}(\varphi)$
        (orange curve via Eqn.\ \ref{eqn:F_L}).
    }
\end{figure}


\subsection{gravitational transport}
\label{subsec:gravitational_flux}

The ringlet's viscous ${\cal F}_{L,\nu}$ and gravitational ${\cal F}_{L,g}$
angular momentum fluxes are shown Fig.\ \ref{fig:F_vs_longitude_nominal}. That Figure
shows how viscous friction tends to transport angular momentum radially inwards, ${\cal F}_{L,\nu}(\varphi)<0$, 
at longitudes nearer periapse where $|\varphi|\sim0$, and outwards
at all other longitudes, with that flux reversal being due to the
reversal of the ringlet's angular velocity gradient (Fig.\ \ref{fig:nominal_shear}). 
Figure \ref{fig:F_vs_longitude_nominal} also shows that the ringlet's gravitational
transport of angular momentum is inwards as
ring-matter approaches periapse where $\varphi<0$, 
and is outwards ${\cal F}_{L,g}(\varphi)>0$ post-periapse, with that asymmetry being due to the ringlet's
negative periapse twist, $\tilde{\omega}'<0$ (Fig.\ \ref{fig:de_prime_nominal}).


Figure \ref{fig:nominal_energy_luminosity} shows the ringlet's viscous ${\cal L}_{E,\nu}$ 
and gravitational luminosity ${\cal L}_{E,g}$ over time.
That Figure's gravitational angular momentum luminosity is computed via
\begin{equation}
    \label{eqn:L_g}
    {\cal L}_{E,g}(a) = \oint {\cal F}_{E,g}(\varphi)rd\varphi = \oint \lambda r\mathbf{A}^1_g\cdot\mathbf{v}d\varphi
\end{equation}
where $\mathbf{A}^1_g$ is the one-sided gravitational acceleration experienced by a particle in streamline $a$.
Note that even though ${\cal F}_{E,\nu}$ and ${\cal F}_{E,g}$ have very different spatial dependances,
the influence of viscosity and gravity still conspire to sum to zero
in the orbit-integrated sense such that ${\cal L}_{E}=\oint ({\cal F}_{E,\nu}+{\cal F}_{E,g})rd\varphi=0$ 
after the ringlet has settled into the self-confining state.

Note that Fig.\ \ref{fig:nominal_energy_luminosity} also shows that 
the ringlet's gravitational energy luminosity is zero. Which is to be expected since 
the streamlines' gravitating ellipses only interact via their secular
perturbations, and secular perturbations do no work \citep{BC61}, hence ${\cal L}_{E,g}=0$.
That this quantity evaluates to zero $\pm5\times10^{-24}$ (in nautural units) can also be regarded
as another test of the  epi\_int\_lite integrator.

\begin{figure}
    \plotone{figs/nominal_energy_luminosity.pdf}
    \caption{
        \label{fig:nominal_energy_luminosity}
        Nominal ringlet's viscous energy luminosity ${\cal L}_{E,\nu}$ (blue curve) versus time $t/\tau_\nu$
        and in units of a circular ring's viscous energy luminosity ${\cal L}_{E,\nu,c}$, 
        as well as the ringlet gravitational energy luminosity ${\cal L}_{E,g}$ (orange curve).
    }
\end{figure}


\subsection{variations with ringlet width, mass, and viscosity}
\label{subsec:variations}

To assess whether the nominal ringlet's evolution is typical of other ringlets
having alternate values of initial width $\Delta a$, total masses $m_r$, and shear viscosity $\nu_s$,
a survey of 1154 additional ringlet simulations are executed. 
The survey ringlets are similar to the nominal ringlet 
with $N_s=2$ streamlines having $N_p=241$ particles per streamline, initial 
eccentricity $e=0.01$, initial eccentricity gradient $e'=0$, and viscosities $\nu_b=\nu_s$. 
But the survey ringlets instead have
total masses that are geometrically distributed between $1.3\times10^{-10}\le m_r\le1.3\times10^{-8}$,
shear viscosities geometrically distributed 
between $3.1\times10^{-13}\le \nu_s\le3.1\times10^{-10}$,
and initial radial widths linearly distributed between  
$0.0003\le \Delta a\le0.0016$. Survey results are summarized in Fig.\ \ref{fig:sim_grid_da}
where blue, green and orange squares indicate those ringlets did evolve into a self-confining state,
with pink diamonds to indicate those simulations described below as ``partially confined''.

\begin{figure}
    \gridline{\fig{figs/sim_grid_da_0p0003.pdf}{0.5\textwidth}{}\fig{figs/sim_grid_da_0p0005.pdf}{0.5\textwidth}{}}
    \gridline{\fig{figs/sim_grid_da_0p0008.pdf}{0.5\textwidth}{}\fig{figs/sim_grid_da_0p0012.pdf}{0.5\textwidth}{}}
    \gridline{\fig{figs/sim_grid_da_0p0016.pdf}{0.7\textwidth}{}}
    \caption{
        \label{fig:sim_grid_da}
        Outcomes for 1155 ringlet simulations having a variety of ringlet
        masses $m_r$, shear viscosities $\nu_s$, with each panel showing results
        for ringlets having the same initial radial width,
        $\Delta a=0.0003, 0.0005, 0.0008, 0.0012$, or  $0.0016$. Colored squares indicate
        those ringlets that evolve into the self-confining state with the indicated libration
        amplitudes $\Delta q$, pink diamonds for those simulations that are partially confined, 
        and $\times$ for ringlets that terminate early when an epi\_int\_lite particle crossed an 
        adjacent streamline. Black numbers indicate the IDs of selected simulations whose time-evolution
        are shown in Fig.\ \ref{fig:low_libration_sims}, and the nominal ringlet
        simulation has ID=345. Pink numbers indicate selected partially confined ringlet simulations
        whose evolutions are also plotted in Fig.\ \ref{fig:e_prime_q_vs_time}.
    }
\end{figure}

Five panels are shown in Fig.\ \ref{fig:sim_grid_da},  one for each value of initial $\Delta a$,
and the colored squares in these panels show that there is a single 
island in the three-dimensional ($\Delta a, m_r, \nu_s$) parameter space where survey
simulations do evolve into the self-confining state. Blue squares represent those ringlets
that settle into self-confinement with low libration amplitudes, and these ringlets
have a nonlinear parameter $q$ that varies by no more than $\Delta q \le 6\times10^{-4}$ 
as the ringlet librates about equilibrium during the simulation's final 20\%.
Green squares indicated those ringlets that are librating with higher amplitudes, 
$6\times10^{-4} < \Delta q \le 4\times10^{-3}$, after settled into self-confinement, 
while orange squares indicate those self-confining ringlets that are most disturbed,
with $\Delta q > 4\times10^{-3}$.

Pink diamonds indicate simulations that are ``partially'' confined, these ringlets
do achieve a high $q\sim0.9$, but angular momentum flux reversal is not complete
and so their viscous spreading is only slowed not stalled, which 
is also detailed in the lowest row of plots in Fig.\ \ref{fig:low_libration_sims}.

The $\times$ simulations in Fig.\ \ref{fig:sim_grid_da}
terminated early when an epi\_int\_lite particle crossed a 
neighboring streamline. In reality, strong 
pressure forces would have developed as adjacent streamlines converged
and enhanced particle densities and particle collisions, with ring particles
possibly rebounding off this high-density region and/or splashing vertically,
none of which is accounted for with this version of epi\_int\_lite. 
So this survey simply terminates all such simulations and flags that occurrence with an 
$\times$ in Fig.\ \ref{fig:sim_grid_da}. Keep in mind though that this does not mean
that these particular ringlets would not evolve into a self-confining state. Instead,
the streamlines in these ringlets would evolve so close to each other that a more sophisticated
and possibly nonlinear treatment of pressure effects is needed 
to accurately assess these ringlets' fates.

The black numbers in Fig.\ \ref{fig:sim_grid_da} are the IDs of a selection of 
ringlet simulations that settle into full or partial self-confinement, 
and the time-histories of those ringlets are
shown in Fig.\ \ref{fig:low_libration_sims}. Each row of plots there shows
the time-evolution of the ringlets' nonlinear parameter $q$, semimajor axis width
$\Delta a$, and eccentricity $e$ for ringlets having the same or similar
mass $m_r$ and viscosity $\nu_s$. The libration amplitudes $\Delta q$
that are indicated in Fig.\ \ref{fig:sim_grid_da} via color-coded squares are simply
the $q$ variations observed in the final $20\%$ of the evolutions
seen in Fig.\ \ref{fig:low_libration_sims}.
The lowest row of plots in Fig.\ \ref{fig:low_libration_sims}
show the evolutions of the partially-confined ringlet simulations that are
indicated  by pink squares in Fig.\ \ref{fig:sim_grid_da}, that row
shows that though these simulations have nonlinearity parameters
that do exceed the theoretical $q=\sqrt{3}/2$ limit expected for self-confinement,
those ringlets' $\Delta a$ still slowly spread and thus are designed 
``partially'' confined.  Close inspection
of the $\Delta a$ curves in the row above show that those ringlets' semimajor axes
also spread albeit more slowly. So it is probably safer to say that the
simulations in the upper rows of Fig.\ \ref{fig:low_libration_sims}
are more self-confining that those in the lower rows.

\begin{figure}
    \gridline{\fig{figs/low_libration_sims_0.pdf}{1.0\textwidth}{}}
    \gridline{\fig{figs/low_libration_sims_1.pdf}{1.0\textwidth}{}}
    \gridline{\fig{figs/low_libration_sims_2.pdf}{1.0\textwidth}{}}
    \vspace{5ex}\ \\
\end{figure}
\begin{figure}
    \gridline{\fig{figs/low_libration_sims_3.pdf}{1.0\textwidth}{}}
    \gridline{\fig{figs/low_libration_sims_4.pdf}{1.0\textwidth}{}}
    \gridline{\fig{figs/low_libration_sims_5.pdf}{1.0\textwidth}{}}
    \vspace{5ex}\ \\
\end{figure}
\begin{figure}
    \gridline{\fig{figs/low_libration_sims_6.pdf}{1.0\textwidth}{}}
    \caption{
        \label{fig:low_libration_sims}
        Each row of plots shows
        ringlets' nonlinear parameter $q$ (left plot), semimajor axis width
        $\Delta a$ (middle plot), and streamline's outer, mean, and inner eccentricities $e$ (right plot)
        versus time $t$
        for ringlets having the same or similar mass $m_r$ and viscosity $\nu_s$, for each
        simulation whose black IDs are indicted in Fig.\ \ref{fig:sim_grid_da}. All quantities are plotted 
        versus $t/\tau_{dyn}$ where each ringlet's dynamical timescale $\tau_{dyn}$
        is Eqn.\ (\ref{eqn:tau-dyn}).
    }
\end{figure}

The quantities shown in Fig.\ \ref{fig:low_libration_sims} are plotted versus 
$t/\tau_{dyn}$ where $\tau_{dyn}$ is the simulated ringlet's
dynamical timescale
\begin{equation}
    \label{eqn:tau-dyn}
    \tau_{dyn} = \tau_{\nu, n}\left(\frac{m_r}{m_{r,n}}\right)^\alpha
        \left(\frac{\nu_s}{\nu_{s,n}}\right)^\beta 
        \left(\frac{\Delta a}{\Delta a_{n}}\right)^\gamma,
\end{equation}
which is assumed to be a power-law in the ringlet's physical properties
$m_r$, $\nu_s$, $\Delta a$, where 
$m_{r,n}=5\times10^{-10}$ is the nominal ringlet's mass, 
$\nu_{s,n}=2.5\times10^{-12}$ is the nominal ringlet's shear viscosity, 
$\Delta a_{n}=3\times10^{-4}$ is the nominal ringlet's initial semimajor axis width,
and $\tau_{\nu, n} = 3\times10^3$ is the nominal ringlet's viscous timescale, 
Eqn.\ (\ref{eqn:viscous-timesscale}).
The exponents in Eqn.\ (\ref{eqn:tau-dyn}) are $\alpha=0.5$, $\beta=-0.5$, $\gamma=0.0$,
and are chosen so that the $q$ versus $t/\tau_{dyn}$ curve for all simulations
in Fig.\ \ref{fig:low_libration_sims} overlaps as much as possible, as
seen in Fig.\ \ref{fig:q_vs_ID}. Equation (\ref{eqn:tau-dyn}) is used here to anticipate
execution times for the various simulations shown in Fig.\ \ref{fig:sim_grid_da}, 
which varies by a factor of $\sim500$, and all simulations shown in 
Figs.\ \ref{fig:sim_grid_da}--\ref{fig:q_vs_ID} are evolved for the greater of $10\tau_{dyn}$ or $10\tau_\nu$.
\begin{figure}
    \plotone{figs/q_vs_ID.pdf}
    \caption{
        \label{fig:q_vs_ID}
        Nonlinear parameter $q$ is plotted versus time for each of the ID'ed
        simulations shown in Figs.\ \ref{fig:sim_grid_da} and \ref{fig:low_libration_sims},
        with time $t$ scaled by each ringlet's empirical dynamical timescale $\tau_{dyn}$,
        Eqn.\ (\ref{eqn:tau-dyn}). Thick red curve shows the evolution of the
        nominal ringlet whose ID=345. All other ringlet trajectories are distributed
        about the nominal ringlet's trajectory, which indicates that Eqn.\ \ref{eqn:tau-dyn} 
        is an adequate estimator of a ringlet's dynamical evolution timescale
        when $\alpha=0.5$, $\beta=-0.5$, $\gamma=0.0$.
    }
\end{figure}

\subsection{partial self--confinement}
\label{subsec:partial}

The evolution of
a selection of partially self confined ringlet simulations, as well as the nominal ringlet whose ID=345, 
are also shown in Fig.\ \ref{fig:e_prime_q_vs_time},
which plots ringlet's eccentricity gradient $e'$ versus time $t/\tau_{dyn}$. All of these ringlets
achieve nonlinearity parameters $q\simeq\sqrt{3}/2\simeq0.866$ after time $t\gtrsim$ a few $\tau_{dyn}$, 
but these ringlet's eccentricity gradients are significantly less than $0.866$, nominal ringlet excepted.
In fact the range of simulated ringlet's $e'$ almost spans the entire 
range of eccentricity gradients observed among Saturn's most well-studied narrow eccentric
ringlets, namely, the Maxwell, Titan, Laplace, and Huygens ringlets, whose $e'$ are
indicated by the black horizontal line in Fig.\ \ref{fig:e_prime_q_vs_time}. Also keep in mind that
Fig.\ \ref{fig:e_prime_q_vs_time} is not an apples-to-apples comparison of simulated ringlets to 
observed ringlets, since the simulations reported in Fig.\ \ref{fig:e_prime_q_vs_time} all have a common 
semimajor axis width $\Delta a$, eccentricity $e_0$,  and very similar viscosities $\nu_s$,
whereas the observed ringlets have a spectrum of physical properties ($e_0$, $\Delta a$, $m_r$, $\nu_s$).
The main point of Fig.\ \ref{fig:e_prime_q_vs_time} is that, if the known narrow eccentric
ringlets are in fact self-confining, then they are of the partially self confined variety,
which means that they have a nonlinearity parameter $q\simeq\sqrt{3}/2\simeq0.866$, an eccentricity gradient
$e'$ that is significantly less than $0.866$, but also a periapse twist $|\tilde{\omega}'|$ that is not
negligable per Eqn.\ (\ref{eqn:q}). 

Section \ref{subsec:eccentricity} will derive the rate at which
a self-confining ringlet's eccentricity $e$ decays over time due to viscosity, Eqns.\ (\ref{eqn:de2/dt_v2}--\ref{eqn:e(t)}),
and all ringlets shows in Figs.\ \ref{fig:low_libration_sims}--\ref{fig:e_prime_q_vs_time},
which includes fully as well as partially self-confining ringlets, all have eccentricities $e$
that decay at the expected rates.
\begin{figure}
    \plotone{figs/e_prime_q_vs_time.pdf}
    \caption{
        \label{fig:e_prime_q_vs_time}
        Eccentricity gradient $e'$ versus time $t/\tau_{dyn}$ for selected partially self-confining
        ringlets whose simulation IDs are indicated on the right of this Figure and
        as pink text in Fig.\ \ref{fig:sim_grid_da}.
        Black horizontal lines show $e'$ for Saturn's Maxwell, Titan, Laplace, and Huygens ringlets,
        and the dotted line indicates the $e'=\sqrt{3}/2$ threshold.
    }
\end{figure}


\subsection{variations with ringlet viscosity}
\label{subsec:viscosity-variations}

Figure \ref{fig:wt_prime_vs_time} shows the periapse twist $\tilde{\omega}' \simeq ea\Delta\tilde{\omega}/\Delta a$ versus time for five ringlets
having the same initial $e_0$, $\Delta a$, and $m_r$ as the nominal ringlet but differing viscosities $\nu_s$;
that plot shows that $|\tilde{\omega}'|$ varies with $\nu_s$, so if this quantity can be measured in a
self-confining ringlet, then its viscosity could be inferred. 

\begin{figure}
    \plotone{figs/wt_prime_vs_time.pdf}
    \caption{
        \label{fig:wt_prime_vs_time}
        Periapse twist $\tilde{\omega}'$ is plotted versus time $t/\tau_\nu$ for five ringlets
        having the same initial $e_0$, $\Delta a$, $m_r$ as the nominal ringlet (whose simulation ID=345)
        but differing viscosities $\nu_s$ that range over $0.5\nu_n\le\nu_s\le2\nu_n$
        where $\nu_n=2.5\times10^{-12}$ is the nominal ringlet's shear visocity.
    }
\end{figure}

\subsection{variations with initial eccentricity}
\label{subsec:e-variations}

Additional simulations are used to assess how outcomes depend upon the ringlet's initial eccentricity $e_0$.
Figure \ref{fig:e0} shows seven simulations of the nominal ringlet that all have identical
physical properties (mass, initial width $\Delta a$) but differing initial $e_0$ ranging
over $0\le e_0\le 0.025$, and two types of outcomes are observed. Higher $e_0$ simulations having $e_0\gtrsim0.005$ 
evolve into the self-confining state with $q\simeq\sqrt{3}/2$ and constant width $\Delta a$
(e.g.\ the lower purple, brown and dark-blue curves). However 
lower $e_0\lesssim0.005$ (red, green, orange) simulations are only 
are partially self--confining in that self-gravity does not pump up the ringlet's $q$
sufficient for self-confinement, so these simulated ringlet's $\Delta a$ spreads radially
albeit slower than the circular ringlet (uppermost blue curve).
These bifurcated outcomes suggest that the nominal ringlet has a
separatrix that divides true self-confinement (which requires $e_0\gtrsim0.005$) from partial or no
confinement. Thus in turn suggests that the partially confined ringlet's (pink diamonds) seen in
Fig.\ \ref{fig:sim_grid_da} might instead have achieved 
true confinement had they started with sufficiently high initial $e_0$.

\begin{figure}
    \plotone{figs/e0.pdf}
    \caption{
        \label{fig:e0}
        Simulations of seven nominal ringlets having a variety of initial eccentricities $0\le e_0\le 0.025$.
        Plot shows each ringlet's semimajor axis width $\Delta a$ in units of its initial $\Delta a_0$
        versus time $t/\tau_\nu$, and simulations having higher initial $e_0\gtrsim0.005$ 
        (lower purple, brown and dark-blue curves) evolve into the self-confining state
        with nonlinearity parameter $q\simeq\sqrt{3}/2$. Ringlets having lower initial $e_0\lesssim0.005$
        (red, green, and orange curves) are partially self-confining, while the $e_0=0$ ringlet (upper blue curve)
        is always unconfined and experiences fastest radial spreading.
    }
\end{figure}

\subsection{eccentricity damping}
\label{subsec:eccentricity}

Viscous friction within the ringlet is a result of dissipative collisions among ringlet particles.
Particle collisions generate heat that is radiated into space, and the source of that radiated energy
is the ringlet's orbital energy $E_r=-m_rGM/2a + E_{sg}$ where $m_r$ is the ringlet's total
mass, $a$ its semimajor axis, and $E_{sg}$ is the ringlet's energy due to its self gravity
which is contant when the ringlet is self-confining. 
Collisions conserve angular momentum, so the ringlet's total angular momentum
$L_r=m_r\sqrt{GMa(1-e^2)}$ is constant so $dL_r/dt=0$ implies
\begin{equation}
    \label{eqn:e2-dot}
    \frac{de^2}{dt} \simeq \frac{1}{a}\frac{da}{dt}
\end{equation}
to lowest order in the ringlet's small eccentricity $e$.
The ringlet's energy dissipation rate is $\dot{E}_r = dE_r/dt=m_rGM\dot{a}/2a^2$ so
$\dot{a}\simeq2\dot{E_r}/m_ra\Omega^2$ and 
\begin{equation}
    \label{eqn:de2/dt}
    \frac{de^2}{dt} \simeq \frac{2\dot{E_r}}{m_r a^2\Omega^2}
\end{equation}
where $GM\simeq a^3\Omega^2$ to lowest order in $J_2$. Also note that
the surface area of energy dissipation within a viscous disk is
\begin{equation}
    \delta = -\nu_s\sigma(r\omega')^2
\end{equation}
(\citealt{P81} I think) where $\omega=v_\theta/r$ is the angular velocity and 
$\omega'=\partial\omega/\partial r$ its radial gradient.

Now consider a small tangential segment within the ringlet whose length is $d\ell=rd\varphi$ where 
$\varphi$ is the segment's longitude measured from the ringlet's periapse and
$d\varphi$ is the small segment's angular extent. The segment's area is 
$dA=\Delta rd\ell=r\Delta r d\varphi$
where $\Delta r$ is the ringlet's radial width.
The rate at which that patch's viscosity dissipates orbital energy is $d\dot{E_r}=\delta dA$, so
the ringlet's total energy dissipation rate is 
$\dot{E}_r = \oint d\dot{E_r}$ when integrated about the ringlet's circumference, and so
$\dot{E}_r = -2\nu_s\lambda\int_0^\pi r^3\omega'^2d\varphi$
since the ringlet's linear density $\lambda=\sigma\Delta r\simeq m_r/2\pi a$. So the
total energy loss rate due to ringlet viscosity becomes
\begin{equation}
    \label{eqn:dE_r/dt}
    \dot{E}_r \simeq -\frac{9}{4}I(e')m_r\nu_s\Omega^2
\end{equation}
when Eqn.\ (\ref{eqn:domega-dr}) is used to replace $\omega'$, and the integral 
\begin{equation}
    I(e') =  \frac{1}{\pi}\int_0^\pi\left(\frac{1-\frac{4}{3}e'\cos\varphi}{1-e'\cos\varphi}\right)^2d\varphi .
\end{equation}
Note that  $I(e')$ is of order
unity except when $e'$ is very close to 1, and numerical evaluation shows that $I(e')\simeq0.889$
when $e'=\sqrt{3}/2$.

Inserting Eqn.\ (\ref{eqn:dE_r/dt}) into (\ref{eqn:de2/dt}) then yields the rate at which $e^2$
is damped,
\begin{equation}
    \label{eqn:de2/dt_v2}
    \frac{de^2}{dt} = -\frac{9I\nu_s}{2a^2}
\end{equation}
which is easily integrated to obtain
\begin{equation}
    \label{eqn:e(t)}
    e(t) = e_0\sqrt{1-\frac{t}{\tau_e}}
\end{equation}
where $e_0$ is the ringlet's initial eccentricity and
\begin{equation}
    \label{eqn:tau_e}
    \tau_e = \frac{2a^2e_0^2}{9I\nu_s}
\end{equation}
is the ringlet's eccentricity damping timescale.
These expectations are also confirmed in Fig.\ \ref{fig:e_vs_tau_e}, which plots
$e(t)/e_0$ versus time $t/\tau_e$ using Eqns.\ (\ref{eqn:e(t)}--\ref{eqn:tau_e}),
for each of the numbered simulations seen in Figs.\ \ref{fig:sim_grid_da}--\ref{fig:q_vs_ID},
with good agreement seen between theory and numerical simulation.
\begin{figure}
    \plotone{figs/e_vs_tau_e.pdf}
    \caption{
        \label{fig:e_vs_tau_e}
        Plot of $e(t)/e_0$ versus time $t/\tau_e$ for each of the 
        numbered simulations seen in Figs.\ \ref{fig:sim_grid_da}--\ref{fig:q_vs_ID},
        while the dashed curve is the expected behavior, Eqn.\ (\ref{eqn:e(t)}).
        These simulations have values of $\tau_e$ ranging over...,
        and thick red curve is the nominal ringlet whose ID=345.
    }
\end{figure}

So viscosity circularizes the ringlet in time $\tau_e$, during which time the ringlet's
semimajor axis will have shrunk by $\Delta a=\dot{a}\tau_e=-e_0^2a$ by Eqns (\ref{eqn:e2-dot})
and (\ref{eqn:de2/dt_v2}), so the ringlet's
fractional drift inwards due to viscous damping is
\begin{equation}
    \label{eqn:delta-a}
    \frac{\Delta a}{a} = -e_0^2,
\end{equation}
which is small. And after the ringlet's inner edge damps to zero, its eccentricity gradient $e'$
will then shrink over time, angular momentum flux reversal will diminish, and the ringlet's 
viscous spreading will resume. So self-confinement of narrow eccentric ringlets is only temporary
after all, until time $\tau_e$ has elapsed, which is $\tau_e/2\pi\sim1.6\times10^6$ orbits for 
the nominal model considered here, which is only $\sim10^3$ years for a ringlet orbiting at 
$a\sim10^{10}$ cm about Saturn. Recall from Section \ref{subsec:nominal}
that the viscous lifetime of a non-self-confining
nominal ringlet is only $\tau_\nu/2\pi\sim500$ orbits, so self-confinement evidently
extends the lifetime of a narrow eccentric ringlet by factor of $\sim3000$. But self-confinement
does not solve the ringlet's lifetime problem, because self-confinement is ultimately
defeated by viscous damping of the ringlet's eccentricity.


\subsection{number of streamlines $N_s$}
\label{subsec:num_streamlines}

When the simulated ringlet is composed of $N_s=2$ streamlines, the ringlet's
evolution is largely analytic ({\it c.f.}\ \citealt{BGT82, BGT83}), and those analytic
predictions also provide excellent benchmark tests for the epi\_int\_lite integrator. This subsection 
assesses whether the results obtained for the simpler $N_s=2$ ringlet also applies to
more realistic ringlets having $N_s>2$.

Figures \ref{fig:a_versus_t_streamlines}--\ref{fig:wt_vs_da_streamlines} recompute the nominal
ringlet's evolution but for ringlets having a range of streamlines, $2\le N_s\le31$. 
Figure \ref{fig:a_versus_t_streamlines} shows that ringlets having larger $N_s$
also achieve larger semimajor axis widths $\Delta a = a_{outer} - a_{inner}$. Figure  
\ref{fig:e_vs_da_streamlines} plots each streamlines' final eccentricities $e$
versus their final $\Delta a$, and this plot shows
that all curves have the same $e$ versus $\Delta a$ slope
{\it i.e.}\ all simulated ringlets have the same eccentricity gradient regardless of 
number of streamlines $N_s$. Ditto for $\tilde{\omega}$ versus $\Delta a$, 
Fig.\ \ref{fig:wt_vs_da_streamlines}.
Consequently, the evolution of the simulated ringlets
nonlinearity parameter $q$, which depends on those gradients via Eqn.\ (\ref{eqn:q}), and also
controls how viscosity communicate angular momentum between
the streamlines [e.g.\ Eqn.\ (\ref{eqn:L_nu}) 
and note that $q\simeq e'$ in all simulations considered here], 
is very similar over time for various $N_s$, see Fig.\ \ref{fig:q_versus_t_streamlines}.
The only noteworthy difference between the $N_s=2$ ringlet and the higher $N_s$
ringlets is seen in Fig.\ \ref{fig:wt_vs_da_streamlines}, which 
which shows that the $N_s>2$ ringlets have an outer longitude of peripase that trails
the inner streamline by a factor of $\sim2$. Except for this one distinction,
the evolution of the $N_s>2$ ringlets is very similar to that exhibited by nominal
ringlet composed of $N_s=2$ streamlines 
\begin{figure}
    \plotone{figs/a_versus_t_streamlines.pdf}
    \caption{
        \label{fig:a_versus_t_streamlines}
        The nominal ringlet simulation is repeated for ringlets composed of $N_s=2,5,9,13,21,31$ streamlines
        as indicated by the legend, with all other parameters are identical to that used in Fig.\ \ref{fig:a_nominal}.
        Plot shows how the simulated ringlets' semimajor axis width $\Delta a = a_{outer} - a_{inner}$
        evolve over time $t$ in units of the nominal ringlet's viscous timescale $\tau_\nu$.
    }
\end{figure}
\begin{figure}
    \plotone{figs/e_vs_da_streamlines.pdf}
    \caption{
        \label{fig:e_vs_da_streamlines}
        Simulated ringlets' final eccentricities $e$ are plotted versus their final
        semimajor axis displacement $\Delta a=a-\bar{a}$ where $\bar{a}$ is the mean semimajor
        axis of all particles in each ringlet.
    }
\end{figure}
\begin{figure}
    \plotone{figs/wt_vs_da_streamlines.pdf}
    \caption{
        \label{fig:wt_vs_da_streamlines}
        $\tilde{\omega} = \tilde{\omega}_{outer} - \tilde{\omega}_{inner}$
    }
\end{figure}
\begin{figure}
    \plotone{figs/q_versus_t_streamlines.pdf}
    \caption{
        \label{fig:q_versus_t_streamlines}
        Caption...
    }
\end{figure}

\acknowledgments
\section{Acknowledgments}
\label{sec:Acknowledgments}

This research was supported by the National Science Foundation via Grant No.\ AST-1313013.


\appendix

\section{Appendix A}
\label{sec:Appendix A}

Derive the more accurate drift step used by epi\_int\_lite...

Show that angular velocity $\omega=v_\theta/r\simeq\Omega(1+2e\cos M)$ to
first order in $e$. Then show that
\begin{equation}
    \label{eqn:domega-dr}
    \omega' = \frac{d\omega}{dr} \simeq -\left(\frac{3\Omega}{2a}\right)
        \frac{1-\frac{4}{3}e'\cos M}{1-e'\cos M}
\end{equation}
to lowest order in $e$ where mean anomaly $M\simeq\theta-\tilde{\omega}$.

\section{Appendix B}
\label{sec:Appendix B}

Compare epi\_int\_lite to theoretical predictions

\section{Appendix D}
\label{sec:Appendix D}

This examines the viscous evolution of a narrow eccentric non-gravitating
ringlet that is identical to the nominal ringlet of Section \ref{subsec:nominal} but
with ringlet self-gravity neglected and $J_2=0$.
As the orange curve in Fig.\ \ref{fig:da_nogravity} shows, the non-gravitating ringlet's
radial width $\Delta a$ grows steadily over time due to ringlet viscosity, 
long after the nominal self-gravitating ringlet (blue curve)
has settled into the self-confining state by time $t\sim15\tau_\nu$. This is due to the
ringlet's secular gravitational perturbations of itself,
which tends to excites the ringlet's outer streamline's eccentricity at the expense
of the inner streamline (see Fig.\ \ref{fig:e_nominal}) until the ringlet eccentricity gradient $e'$
(blue curve in Fig.\ \ref{fig:de_prime_nogravity}) grows beyond the
limit required for complete angular momentum flux reversal 
that results in the ringlet's radial confinement (dotted line). 
Note that viscosity also excites the non-gravitating
ringlet's eccentricity gradient some (orange curve), but not sufficiently to halt the ringlet's 
viscous spreading.

\begin{figure}
    \plotone{figs/da_nogravity.pdf}
    \caption{
        \label{fig:da_nogravity}
        Blue curve is the nominal ringlet's semimajor axis width $\Delta a$ versus time $t$,
        and this ringlet's radial spreading ceases by time $t\sim15\tau_\nu$ when it's self-gravity
        has excited the ringlet's eccentricity gradient $e'$ sufficiently; 
        see blue curve in Fig.\ \ref{fig:de_prime_nogravity}. Orange curve shows that
        the non-gravitating ringlet's $\Delta a$ grows without limit due to the ringlet's
        much lower eccentricity gradient. Note that planetary oblateness would
        cause the non-gravitating streamlines to precess differentially and eventually cross
        when $J_s>0$, so the non-gravitating simulation also sets $J_2=0$ 
        to avoid differential precession.
    }
\end{figure}

\begin{figure}
    \plotone{figs/de_prime_nogravity.pdf}
    \caption{
        \label{fig:de_prime_nogravity}
        blah
    }
\end{figure}

\section{Appendix E}
\label{sec:Appendix E}

This Appendix will use the orbit elements derived in Appendix \ref{sec:Appendix A} to
derive Eqn.\ \ref{eqn:F_nu_varphi} from \ref{eqn:F_nu_theta}, and then Eqn.\ (\ref{eqn:L_nu}).

\section{Appendix F}
\label{sec:Appendix F}

Viscous and gravitational energy transport...


\bibliography{jmh_bibliography}
\end{document}


\end{document}




\section{Trash}


\subsection{improved drift step around oblate planet}
\label{subsec:drift}


\subsection{kick}
\label{subsec:kick}



Epi\_int is a drift-kick integrator, and such integrators alternate between drifting
(ie advancing) a particle along its unperturbed trajectory, with each drift followed
by a velocity kick that accounts for all other perturbing forces such as ring self gravity
and ring viscosity. Drifting a particle efficiently along its unperturbed trajectory around
an oblate planet requires an analytic
expression for that trajectory, and epi\_int utilized the \cite{BL94} solution
that requires, at every timestep, the conversion of the particle's spatial coordinates
and velocities into geometric orbit elements, with the drifted particle's
orbit elements then converted back to spatial coordinates every timestep. That conversion is accurate
to order ${\cal O}(e^2)$ where $e$ is the particle's geometric eccentricity, but the
conversion from spatial coordinates to orbit elements and back is not reversible, which
means that the drifted particle's trajectory acquires an ${\cal O}(e^3)$ error
every timestep. Although the accumulation of this error was too slow to significantly impact
epi\_int's B ring simulations spanning $10^4$ orbit periods, this error does preclude 
using that code to simulate the much slower viscous evolution of ringlets over $10^6$ orbit periods.

To avoid this accumulation of drift errors, Section \ref{sec:drift-kick} derives an alternate set of geometric
orbit elements that describe the particle's unperturbed motion around an oblate planet. Note though
the conversion of spatial coordinates to the new geometric orbit elements is exact
and reversible, and so epi\_int\_lite's drift step is not a significant source of error. 

The chief principal guiding the developement of epi\_int\_lite is that the code be
accurate to solve the problem at hand while also being as simple
as possible so that the code can be developed, tested, and executed as swiftly as possble.
With this in mind, several simplifying approximations are made and are detailed
below in Section \ref{subsec:approximations} and they simplify code development and
shorten run times significantly. Section \ref{sec:testing} then assesses the impact
of those approximations, and shows that they are truly negligable and do not affect outcomes
or conclusions.

Although the epi\_int integrator was well-suited for evolving the
B ring edge over the $\sim3\times10^4$ orbits needed to monitor the B ring's response to Mimas
perturbations, that code lacked sufficient numerical accuracy to evolve a ringlet
during the $\sim3\times10^6$? orbits needed to track its slow radial spreading due to ringlet viscosity.
That inability was traced to epi\_int's drift step, and Section ? describes
how that is mitigated in the new code.
